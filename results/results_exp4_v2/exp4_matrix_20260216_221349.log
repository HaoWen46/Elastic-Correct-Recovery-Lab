nohup: ignoring input
[INFO] Matrix prefix: exp4_matrix_20260216_221349
[INFO] Results root: results
[INFO] NPROC: 4
[INFO] PROFILE: small
[INFO] MODELS: resnet18,resnet50
[INFO] DATASETS: cifar10,cifar100
[INFO] FAILURE_SPECS: base:400,1200;late:800,1400
[INFO] CHECKPOINT_EVERY_CSV: 50
[INFO] MAX_INFLIGHT_CSV: 4
[INFO] SKIP_IF_EXISTS: 1
[INFO] RESUME_MATRIX: 1
[INFO] START_RESUME_LATEST: 1
[INFO] DELETE_CHECKPOINTS_ON_COMPLETE: 1
[INFO] DRY_RUN: 0
[INFO] Planned suites: 8
[MATRIX 1/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4 dataset=cifar10 model=resnet18 fail=400,1200 k=50 inflight=4 port_base=39801
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4
Audited 7 packages in 83ms
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar10 (size=50000)
[INFO] Model: resnet18
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0216 22:16:50.379000 425645 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 425669 closing signal SIGTERM
W0216 22:16:50.380000 425645 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 425671 closing signal SIGTERM
E0216 22:16:50.476000 425645 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 425670) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:16:50
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 425672)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:16:50
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 425669)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:16:50
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 425671)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:16:50
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 425670)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0216 22:18:06.863000 426078 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 426094 closing signal SIGTERM
W0216 22:18:06.863000 426078 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 426095 closing signal SIGTERM
W0216 22:18:06.864000 426078 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 426096 closing signal SIGTERM
E0216 22:18:07.029000 426078 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 426093) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:18:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 426094)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:18:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 426095)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:18:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 426096)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:18:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 426093)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=0.651
[ECRL][fail-inject] step=400 close_done_sec=0.724
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:19:31.912000 427109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 427131 closing signal SIGTERM
W0216 22:19:31.913000 427109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 427134 closing signal SIGTERM
E0216 22:19:32.028000 427109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 427132) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:19:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 427133)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:19:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 427131)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:19:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 427134)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:19:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 427132)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=0.531
[ECRL][fail-inject] step=1200 close_done_sec=0.752
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:20:42.805000 427555 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 427569 closing signal SIGTERM
W0216 22:20:42.806000 427555 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 427571 closing signal SIGTERM
W0216 22:20:42.807000 427555 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 427572 closing signal SIGTERM
E0216 22:20:42.937000 427555 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 427570) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:20:42
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 427569)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:20:42
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 427571)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:20:42
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 427572)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:20:42
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 427570)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.02399799565318972,
    "stall_time_sec_total": 13.520381471025757,
    "write_time_sec_total": 13.413594497251324
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.74467851150448,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 129.26674270629883,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771251365.8733356
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 116.40868854522705
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.023539214278571308,
    "stall_time_sec_total": 13.687749781180173,
    "write_time_sec_total": 13.518549244734459
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 10.536263190481444,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 162.37647557258606,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771251530.2426572
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 151.85649514198303
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.0738807506859303e-05,
    "enqueue_latency_sec_total": 4.320932701113634,
    "num_events": 35,
    "snapshot_time_sec_total": 0.024393657338805497,
    "stall_time_sec_total": 5.946570071741007,
    "write_time_sec_total": 0.957495555980131
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 11.449653459563848,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 151.54997897148132,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771251683.694222
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 139.7422206401825
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 185.25295585393906,
    "max_abs_diff": 3.400864601135254,
    "mean_abs_diff": 0.11579717423766851,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "c934301f67f0692d535362c56ec62fecd17ef354376391ef87b049aeaccea118",
      "l2_distance": 303.67859865968734,
      "reference_digest": "2583a4823fa590eb87e465dbf90ae1c9f4b6a1f4f63076a8011845279ec6c644"
    },
    "1600": {
      "available": true,
      "candidate_digest": "47bd3e22c3571d8ba89283a8cd508ce2df4e3f981386fcc6e7f6046fa120f60b",
      "l2_distance": 271.8713164971054,
      "reference_digest": "2361e75f1fb4cc04862b4d7c40cd8eb22b566e4628ade25bc296256499b53600"
    },
    "200": {
      "available": true,
      "candidate_digest": "512af6d6f875a9f3bda23059d0e2155b8ff5edc920fc59715ca05948ffeb5e37",
      "l2_distance": 1896.3211959026996,
      "reference_digest": "34ab5cf2c65e1ebc840c9c8d5998fb37eced76983a6243455a22fc1680d61007"
    },
    "400": {
      "available": true,
      "candidate_digest": "a491ca310ed279a65e0326924cde98a322292d96956fe3f7b7855a6104200da6",
      "l2_distance": 1115.546789838874,
      "reference_digest": "9f64ff0d6cdb811b3168067b8b79804d8b855f16b953823866bdddde9fbd0ef4"
    },
    "800": {
      "available": true,
      "candidate_digest": "be89a7b205c1354dd216a7e690d99a4960bb704574732a194a1b5a04d389add0",
      "l2_distance": 478.7604506450462,
      "reference_digest": "3a9bb3e573c7266745aa15cce1c31b7939b879cb8af6bffc62212298a6ff655b"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 168.50338119268417,
    "max_abs_diff": 2.055572509765625,
    "mean_abs_diff": 0.10532223459333181,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "b172ec85e0bb347e2dbcdc1e98f4eb2d66d82ee5a7ba0b6ae6b6382fb3506a43",
      "l2_distance": 247.57718260017091,
      "reference_digest": "2583a4823fa590eb87e465dbf90ae1c9f4b6a1f4f63076a8011845279ec6c644"
    },
    "1600": {
      "available": true,
      "candidate_digest": "eb7a8955324486da699fc74733749de13ec118d7ffb2feb0d7dd95b2b4b48764",
      "l2_distance": 227.9320044259118,
      "reference_digest": "2361e75f1fb4cc04862b4d7c40cd8eb22b566e4628ade25bc296256499b53600"
    },
    "200": {
      "available": true,
      "candidate_digest": "c1e54ca9d7b770b8c0add321279b010c2d5bf92c0ec57c9e37d67ee4fe7f23f9",
      "l2_distance": 1427.63448135811,
      "reference_digest": "34ab5cf2c65e1ebc840c9c8d5998fb37eced76983a6243455a22fc1680d61007"
    },
    "400": {
      "available": true,
      "candidate_digest": "1f5b30b94b1a232b876e943eea7fb49f6aafbfc77fdd863479755beced7ff6e3",
      "l2_distance": 865.2522444333408,
      "reference_digest": "9f64ff0d6cdb811b3168067b8b79804d8b855f16b953823866bdddde9fbd0ef4"
    },
    "800": {
      "available": true,
      "candidate_digest": "f79331cbf7da4ef231b123fe7052ee54e098732051969575221e7cd386f60f8f",
      "l2_distance": 362.28552672320285,
      "reference_digest": "3a9bb3e573c7266745aa15cce1c31b7939b879cb8af6bffc62212298a6ff655b"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0216 22:25:06.733000 429910 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 429923 closing signal SIGTERM
W0216 22:25:06.734000 429910 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 429925 closing signal SIGTERM
E0216 22:25:06.849000 429910 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 429922) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:25:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 429924)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:25:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 429923)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:25:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 429925)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:25:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 429922)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0216 22:26:08.602000 430208 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 430218 closing signal SIGTERM
W0216 22:26:08.603000 430208 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 430220 closing signal SIGTERM
E0216 22:26:08.699000 430208 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 430219) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:26:08
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 430221)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:26:08
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 430218)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:26:08
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 430220)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:26:08
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 430219)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=0.522
[ECRL][fail-inject] step=400 close_done_sec=0.736
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:27:21.950000 430823 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 430832 closing signal SIGTERM
W0216 22:27:21.951000 430823 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 430833 closing signal SIGTERM
W0216 22:27:21.951000 430823 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 430834 closing signal SIGTERM
E0216 22:27:22.048000 430823 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 430831) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:27:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 430832)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:27:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 430833)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:27:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 430834)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:27:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 430831)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=0.551
[ECRL][fail-inject] step=1200 close_done_sec=0.628
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:28:21.824000 431031 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 431035 closing signal SIGTERM
W0216 22:28:21.824000 431031 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 431036 closing signal SIGTERM
E0216 22:28:21.905000 431031 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 431037) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:28:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 431038)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:28:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 431035)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:28:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 431036)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:28:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 431037)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.023167792009189725,
    "stall_time_sec_total": 11.709805004182272,
    "write_time_sec_total": 11.624626542208716
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 14.495445114281953,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 120.97357869148254,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771251870.6431227
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 110.37950110435486
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.022839393583126366,
    "stall_time_sec_total": 11.32475299644284,
    "write_time_sec_total": 11.240078780334443
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.915022274017815,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 133.73770022392273,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771252006.1996548
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 123.88673949241638
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.2803666070103645e-05,
    "enqueue_latency_sec_total": 4.320537516032346,
    "num_events": 35,
    "snapshot_time_sec_total": 0.025150052970275283,
    "stall_time_sec_total": 5.893739708117209,
    "write_time_sec_total": 0.8958153709536418
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.300785740520363,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 131.44955730438232,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771252139.466176
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 120.29364514350891
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 176.1786466240883,
    "max_abs_diff": 3.530670166015625,
    "mean_abs_diff": 0.11011316429823637,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "b283260675d0847dba38223705dace6753240e0a7403a4aa2277d28ff9ddd79c",
      "l2_distance": 329.92099511643806,
      "reference_digest": "512472aa68845a9bf88f04cd7e1911dbe7b575ec9712abceffce11500b50bd9e"
    },
    "1600": {
      "available": true,
      "candidate_digest": "348c3f76f51e06a20314f3a038af78ba34168c74b6152b5465947b4d979ded3c",
      "l2_distance": 294.5087635936769,
      "reference_digest": "0fede6b834d1c1bc6b529118ce10fe8d1765ec33d93d856632d7f996ad8ba48f"
    },
    "200": {
      "available": true,
      "candidate_digest": "03f1b7647e9b3a27d81b37916c9d4019d0847cdbcd85d115e7e9d534af68f602",
      "l2_distance": 1872.7239174525344,
      "reference_digest": "0b06e15212ace0c666ae31e535acc108611fa2fc87b533502b671deea38fa019"
    },
    "400": {
      "available": true,
      "candidate_digest": "5c8ef3bb434178781009fc6b23a05b58e888d2ef5671e38a27891b1f5b186ecb",
      "l2_distance": 1063.441077888642,
      "reference_digest": "2468640165f0c708d3d303de735f96e10552723a6982816c6a8b5306ce2ed4c3"
    },
    "800": {
      "available": true,
      "candidate_digest": "f3e363698c6b72ffeddfab7eb0d4d46b67d879ebeb2dfe57fad354a26e187dc6",
      "l2_distance": 492.82138603768055,
      "reference_digest": "0a2468480eede8abfd3dabff432c9e68969e265ca27581b955d5640dbb020f08"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 162.14743292331696,
    "max_abs_diff": 2.4854049682617188,
    "mean_abs_diff": 0.10136989325284958,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "fbc52df3cea2b8135b8b19adf356f9bcdc6bbc968223eec7b648efd1fd898338",
      "l2_distance": 340.83745618641046,
      "reference_digest": "512472aa68845a9bf88f04cd7e1911dbe7b575ec9712abceffce11500b50bd9e"
    },
    "1600": {
      "available": true,
      "candidate_digest": "7ad18f8166d010c76a46af369bf05b348f69438d504e98849698ecd228cafba7",
      "l2_distance": 305.9385340342116,
      "reference_digest": "0fede6b834d1c1bc6b529118ce10fe8d1765ec33d93d856632d7f996ad8ba48f"
    },
    "200": {
      "available": true,
      "candidate_digest": "f4154f91472547fc0374c9e11d16a285f28bb72084f2cfcf3bb72f7cd318140a",
      "l2_distance": 2052.816945015426,
      "reference_digest": "0b06e15212ace0c666ae31e535acc108611fa2fc87b533502b671deea38fa019"
    },
    "400": {
      "available": true,
      "candidate_digest": "03231b6e4c51e47438883c52d40535c30ffdf46fdebf552809636effeb4d17d1",
      "l2_distance": 1103.8890629651285,
      "reference_digest": "2468640165f0c708d3d303de735f96e10552723a6982816c6a8b5306ce2ed4c3"
    },
    "800": {
      "available": true,
      "candidate_digest": "4dfbc71837135efff92edfb78b364ce9f3aa0e56a6c595db5ab586de9c40139f",
      "l2_distance": 495.98841040227364,
      "reference_digest": "0a2468480eede8abfd3dabff432c9e68969e265ca27581b955d5640dbb020f08"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_reference seed=4242 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking seed=4242 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0216 22:32:36.926000 432844 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 432863 closing signal SIGTERM
W0216 22:32:36.927000 432844 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 432864 closing signal SIGTERM
W0216 22:32:36.927000 432844 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 432866 closing signal SIGTERM
E0216 22:32:37.057000 432844 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 432862) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:32:37
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 432863)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:32:37
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 432864)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:32:37
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 432866)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:32:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 432862)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0216 22:33:38.381000 433358 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 433384 closing signal SIGTERM
W0216 22:33:38.381000 433358 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 433385 closing signal SIGTERM
W0216 22:33:38.382000 433358 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 433386 closing signal SIGTERM
E0216 22:33:38.479000 433358 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 433387) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:33:38
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 433384)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:33:38
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 433385)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:33:38
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 433386)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:33:38
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 433387)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped seed=4242 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=0.547
[ECRL][fail-inject] step=400 close_done_sec=0.682
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:34:54.105000 433981 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 433991 closing signal SIGTERM
W0216 22:34:54.106000 433981 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 433994 closing signal SIGTERM
E0216 22:34:54.221000 433981 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 433992) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:34:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 433993)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:34:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 433991)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:34:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 433994)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:34:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 433992)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=0.546
[ECRL][fail-inject] step=1200 close_done_sec=0.739
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:35:55.904000 434372 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 434379 closing signal SIGTERM
W0216 22:35:55.904000 434372 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 434380 closing signal SIGTERM
W0216 22:35:55.905000 434372 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 434381 closing signal SIGTERM
E0216 22:35:56.070000 434372 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 434378) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:35:56
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 434379)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:35:56
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 434380)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:35:56
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 434381)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:35:55
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 434378)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.02547708002384752,
    "stall_time_sec_total": 11.245825925958343,
    "write_time_sec_total": 11.16642141866032
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 14.750413622468578,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 118.6741693019867,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771252320.3235047
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 108.47153449058533
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.022582581383176148,
    "stall_time_sec_total": 11.280762886046432,
    "write_time_sec_total": 11.191187350195833
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.79623433569536,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 135.13546800613403,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771252457.308858
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 125.03678488731384
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.5385059416294098e-05,
    "enqueue_latency_sec_total": 4.271540608257055,
    "num_events": 35,
    "snapshot_time_sec_total": 0.02421499800402671,
    "stall_time_sec_total": 5.884870698908344,
    "write_time_sec_total": 0.8824524190276861
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.962951866819711,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 134.87960386276245,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771252594.0215662
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 123.42867708206177
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 165.14119732379913,
    "max_abs_diff": 2.042392373085022,
    "mean_abs_diff": 0.10324882358312606,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "68143b0868a52ff0383233645f2b5a9c1c7739d65d01cc8b04c4c7d78fc11cb8",
      "l2_distance": 211.6642578352494,
      "reference_digest": "4905db475ee7814fd3b320cba2fec72a406e0c194cf5290e8fc1a576150985c3"
    },
    "1600": {
      "available": true,
      "candidate_digest": "4dca73dc8dc653e5efa53a555333cce2d4b3e9cbaebd3188c26353cb6da04135",
      "l2_distance": 190.11722648888457,
      "reference_digest": "654cb9a6d0c415ab19a48d382a59ad4b98c84701cec6ef6ca849a0bf9581ae69"
    },
    "200": {
      "available": true,
      "candidate_digest": "ed9fbddf155ecaecb524508c04cde4a7230b92cea5891e1b6530b6e3010cc2a4",
      "l2_distance": 1472.363524417742,
      "reference_digest": "24d109845e0af4e5c4febf0d1035771d10e06bdae1425307dee6588cb4a0684f"
    },
    "400": {
      "available": true,
      "candidate_digest": "eee6449ef1e93db8b11bf9958593765db46ff7f4833394665bea6bbcb49dbf10",
      "l2_distance": 804.551237075221,
      "reference_digest": "97668c6e48e190886826d145ec698d8d5728e11345bd76d9ee916a98c1ecf14f"
    },
    "800": {
      "available": true,
      "candidate_digest": "c7fa71a5cf96dc0b81374213a0d62ebc6a849c7a6f72de32c31f3f76c0148b02",
      "l2_distance": 342.6456071469359,
      "reference_digest": "f8158203dc2b9d6ff835bdfa084baf672897ace7b24e29767543bcbe3f6b7fd4"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 177.23398196697235,
    "max_abs_diff": 2.1768798828125,
    "mean_abs_diff": 0.11080241404473781,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "6dcc342d3267ace5d5b6e91d9b8eef3aaa28e77fec447d838a69e36181c7cab8",
      "l2_distance": 368.80816161631844,
      "reference_digest": "4905db475ee7814fd3b320cba2fec72a406e0c194cf5290e8fc1a576150985c3"
    },
    "1600": {
      "available": true,
      "candidate_digest": "eb8b5acf74176d4713681906d71e210527b887955de2d29ac66e0c7f98b0d607",
      "l2_distance": 337.9876346359692,
      "reference_digest": "654cb9a6d0c415ab19a48d382a59ad4b98c84701cec6ef6ca849a0bf9581ae69"
    },
    "200": {
      "available": true,
      "candidate_digest": "314da82a020de2ee32204011e89156749541f6bdc66c708e31e1300c39762db6",
      "l2_distance": 1650.9908142272689,
      "reference_digest": "24d109845e0af4e5c4febf0d1035771d10e06bdae1425307dee6588cb4a0684f"
    },
    "400": {
      "available": true,
      "candidate_digest": "c451af705a5478e2ffa913bfe0efdb2b4c0672e2b73d4e96a71ce07938cefce3",
      "l2_distance": 992.2265345886826,
      "reference_digest": "97668c6e48e190886826d145ec698d8d5728e11345bd76d9ee916a98c1ecf14f"
    },
    "800": {
      "available": true,
      "candidate_digest": "998aafd693377a62e01026ab7fa889f13778dca1d793a031843805b7e55376f6",
      "l2_distance": 504.3026620021788,
      "reference_digest": "f8158203dc2b9d6ff835bdfa084baf672897ace7b24e29767543bcbe3f6b7fd4"
    }
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.5916478135286466,
    "mean": 14.33017908275167,
    "n": 3,
    "std": 0.5228388128666596
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_reference",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_reference",
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_reference",
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_reference"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.74467851150448,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_reference",
      "snapshot_time_sec_total": 0.02399799565318972,
      "stall_time_sec_total": 13.520381471025757,
      "wall_clock_time_sec": 116.40868854522705,
      "write_time_sec_total": 13.413594497251324
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 14.495445114281953,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_reference",
      "snapshot_time_sec_total": 0.023167792009189725,
      "stall_time_sec_total": 11.709805004182272,
      "wall_clock_time_sec": 110.37950110435486,
      "write_time_sec_total": 11.624626542208716
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 14.750413622468578,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_reference",
      "snapshot_time_sec_total": 0.02547708002384752,
      "stall_time_sec_total": 11.245825925958343,
      "wall_clock_time_sec": 108.47153449058533,
      "write_time_sec_total": 11.16642141866032
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0013236845969213176,
    "mean": 0.02421428922874232,
    "n": 3,
    "std": 0.0011697392729918632
  },
  "stall_time_sec_total": {
    "ci95": 1.3600531701517573,
    "mean": 12.15867080038879,
    "n": 3,
    "std": 1.2018781590295728
  },
  "wall_clock_time_sec": {
    "ci95": 4.6883177303477135,
    "mean": 111.75324138005574,
    "n": 3,
    "std": 4.1430635260144095
  },
  "write_time_sec_total": {
    "ci95": 1.3437198267518378,
    "mean": 12.068214152706787,
    "n": 3,
    "std": 1.187444393403996
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 1.5168083422333376,
    "mean": 12.082506600064873,
    "n": 3,
    "std": 1.340402609230848
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_failure_blocking",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking",
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking",
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 10.536263190481444,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking",
      "snapshot_time_sec_total": 0.023539214278571308,
      "stall_time_sec_total": 13.687749781180173,
      "wall_clock_time_sec": 151.85649514198303,
      "write_time_sec_total": 13.518549244734459
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 12.915022274017815,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking",
      "snapshot_time_sec_total": 0.022839393583126366,
      "stall_time_sec_total": 11.32475299644284,
      "wall_clock_time_sec": 123.88673949241638,
      "write_time_sec_total": 11.240078780334443
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 12.79623433569536,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking",
      "snapshot_time_sec_total": 0.022582581383176148,
      "stall_time_sec_total": 11.280762886046432,
      "wall_clock_time_sec": 125.03678488731384,
      "write_time_sec_total": 11.191187350195833
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.000560278190274369,
    "mean": 0.02298706308162461,
    "n": 3,
    "std": 0.000495117495881607
  },
  "stall_time_sec_total": {
    "ci95": 1.5583934436793752,
    "mean": 12.097755221223148,
    "n": 3,
    "std": 1.3771513380790334
  },
  "wall_clock_time_sec": {
    "ci95": 17.909716770405268,
    "mean": 133.59333984057108,
    "n": 3,
    "std": 15.826805814035872
  },
  "write_time_sec_total": {
    "ci95": 1.5048261865752803,
    "mean": 11.98327179175491,
    "n": 3,
    "std": 1.3298139855655655
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 1.1155458150201132,
    "mean": 12.571130355634642,
    "n": 3,
    "std": 0.9858071580539125
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_failure_overlapped",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 11.449653459563848,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped",
      "snapshot_time_sec_total": 0.024393657338805497,
      "stall_time_sec_total": 5.946570071741007,
      "wall_clock_time_sec": 139.7422206401825,
      "write_time_sec_total": 0.957495555980131
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.300785740520363,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped",
      "snapshot_time_sec_total": 0.025150052970275283,
      "stall_time_sec_total": 5.893739708117209,
      "wall_clock_time_sec": 120.29364514350891,
      "write_time_sec_total": 0.8958153709536418
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 12.962951866819711,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped",
      "snapshot_time_sec_total": 0.02421499800402671,
      "stall_time_sec_total": 5.884870698908344,
      "wall_clock_time_sec": 123.42867708206177,
      "write_time_sec_total": 0.8824524190276861
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0005617111554430578,
    "mean": 0.024586236104369164,
    "n": 3,
    "std": 0.0004963838063293854
  },
  "stall_time_sec_total": {
    "ci95": 0.03774808042359613,
    "mean": 5.908393492922187,
    "n": 3,
    "std": 0.03335795570503296
  },
  "wall_clock_time_sec": {
    "ci95": 11.816190509580414,
    "mean": 127.8215142885844,
    "n": 3,
    "std": 10.44196036454411
  },
  "write_time_sec_total": {
    "ci95": 0.04529839943867582,
    "mean": 0.9119211153204864,
    "n": 3,
    "std": 0.04003016802517144
  }
}
{
  "markdown": "results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_publishable.md",
  "json": "results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_publishable.json"
}
[INFO] Cleaning checkpoints for completed runs...
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s1337_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s2027_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_s4242_failure_overlapped
[DONE] Publishable markdown: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_publishable.md
[DONE] Publishable json: results/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4_publishable.json
[MATRIX 2/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4 dataset=cifar10 model=resnet18 fail=800,1400 k=50 inflight=4 port_base=39851
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar10 (size=50000)
[INFO] Model: resnet18
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0216 22:40:46.701000 436511 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 436529 closing signal SIGTERM
W0216 22:40:46.702000 436511 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 436532 closing signal SIGTERM
E0216 22:40:46.817000 436511 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 436530) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:40:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 436531)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:40:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 436529)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:40:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 436532)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:40:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 436530)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0216 22:41:35.005000 436945 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 436954 closing signal SIGTERM
W0216 22:41:35.006000 436945 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 436955 closing signal SIGTERM
E0216 22:41:35.121000 436945 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 436953) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:41:35
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 436956)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:41:35
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 436954)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:41:35
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 436955)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:41:35
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 436953)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=0.541
[ECRL][fail-inject] step=800 close_done_sec=0.620
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:43:00.801000 437464 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 437469 closing signal SIGTERM
W0216 22:43:00.801000 437464 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 437470 closing signal SIGTERM
W0216 22:43:00.802000 437464 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 437471 closing signal SIGTERM
E0216 22:43:00.968000 437464 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 437472) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:43:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 437469)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:43:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 437470)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:43:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 437471)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:43:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 437472)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=0.551
[ECRL][fail-inject] step=1400 close_done_sec=0.578
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:43:48.285000 438122 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 438133 closing signal SIGTERM
W0216 22:43:48.286000 438122 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 438135 closing signal SIGTERM
W0216 22:43:48.287000 438122 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 438136 closing signal SIGTERM
E0216 22:43:48.416000 438122 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 438134) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:43:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 438133)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:43:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 438135)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:43:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 438136)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:43:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 438134)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.020832865266129375,
    "stall_time_sec_total": 11.260528670274653,
    "write_time_sec_total": 11.176854046992958
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 15.304895393910227,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 115.02482891082764,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771252784.326655
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 104.54171419143677
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.024656069930642843,
    "stall_time_sec_total": 11.642468529753387,
    "write_time_sec_total": 11.555210054852068
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.034938653570444,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 133.14091539382935,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771252919.3188043
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 122.74702954292297
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.6474823243916035e-05,
    "enqueue_latency_sec_total": 4.353773107286543,
    "num_events": 35,
    "snapshot_time_sec_total": 0.02546488679945469,
    "stall_time_sec_total": 5.940359962056391,
    "write_time_sec_total": 0.8786803450202569
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.210409939876754,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 132.32127380371094,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771253053.5639327
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 121.11660480499268
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 199.41483384370804,
    "max_abs_diff": 2.914306640625,
    "mean_abs_diff": 0.12464194741100072,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "90dc8afa555862fb7f69496570721d7c957382bedd832003d09662e8bf21560e",
      "l2_distance": 405.01394817469924,
      "reference_digest": "952a03dd6cbda3102e0e19deb55f7cdc81ec308ca81d74749dd67d7423af4443"
    },
    "1600": {
      "available": true,
      "candidate_digest": "a642f27d903701fd5bcb33eb418916b925f6d95c01bb1a506663f42f5220bdb4",
      "l2_distance": 371.2450560110819,
      "reference_digest": "9c92bdc99c5aa4588377a083ff2a1eb645b79ec69708f2a5ff66a0a05788aed2"
    },
    "200": {
      "available": true,
      "candidate_digest": "204340d993e0ac23dd52d36ffb6340397cccdea7a36cdaebd182781447789c3c",
      "l2_distance": 2466.298999223302,
      "reference_digest": "d310a4f3a06802a60e57d6c29f339f17bc9149c1dc8dda598167672c3fb03188"
    },
    "400": {
      "available": true,
      "candidate_digest": "2d9c379e447f1f74a84fcb6dc3e578263c46b7e33cc1ec902f3d0e637c255bb1",
      "l2_distance": 1350.4760508934403,
      "reference_digest": "d61b4c6efcd8368b9ad2f17bf6fbd7705f2504d2aec6cbe055931e23dd97d84b"
    },
    "800": {
      "available": true,
      "candidate_digest": "97b41860cd555305422cbbc9f2cb91ce26162948661c4721bea3c65dee825215",
      "l2_distance": 585.976322327227,
      "reference_digest": "dc7cf0af2f477ea1fa945bdbe126fc0bb74dad0b2ae47a69325a88f3adc8fb54"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 180.9747515320778,
    "max_abs_diff": 3.28607177734375,
    "mean_abs_diff": 0.11314328346401453,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "9061785e47a12b75789122a6e2f67911aec9434adf0e0e833e972eedaf2e5202",
      "l2_distance": 382.3806481113959,
      "reference_digest": "952a03dd6cbda3102e0e19deb55f7cdc81ec308ca81d74749dd67d7423af4443"
    },
    "1600": {
      "available": true,
      "candidate_digest": "26d0faf1f4f0f705fbd81f5e54ad82dd8835ba9a5cfc91a5d8530f3c21dc4c79",
      "l2_distance": 339.4080252524471,
      "reference_digest": "9c92bdc99c5aa4588377a083ff2a1eb645b79ec69708f2a5ff66a0a05788aed2"
    },
    "200": {
      "available": true,
      "candidate_digest": "ee54242ff534348b65723554becb2e30f5e4e93bfd54c833bdc87e7239091416",
      "l2_distance": 2472.4117437611353,
      "reference_digest": "d310a4f3a06802a60e57d6c29f339f17bc9149c1dc8dda598167672c3fb03188"
    },
    "400": {
      "available": true,
      "candidate_digest": "18fe26fd90a0995d66a7667d5dae00eebe544d1269f4c57e4ffabed8767c4b36",
      "l2_distance": 1382.2347716175814,
      "reference_digest": "d61b4c6efcd8368b9ad2f17bf6fbd7705f2504d2aec6cbe055931e23dd97d84b"
    },
    "800": {
      "available": true,
      "candidate_digest": "1578c81058363af5945dcca49fed3308e03606ba18bc3bac3f1878fd0f7d9bfd",
      "l2_distance": 583.3322523703579,
      "reference_digest": "dc7cf0af2f477ea1fa945bdbe126fc0bb74dad0b2ae47a69325a88f3adc8fb54"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0216 22:48:19.634000 439801 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 439824 closing signal SIGTERM
E0216 22:48:19.699000 439801 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 439823) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:48:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 439826)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:48:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 439827)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:48:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 439824)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:48:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 439823)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0216 22:49:10.367000 440230 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 440242 closing signal SIGTERM
W0216 22:49:10.368000 440230 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 440243 closing signal SIGTERM
W0216 22:49:10.368000 440230 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 440244 closing signal SIGTERM
E0216 22:49:10.534000 440230 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 440245) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:49:10
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 440242)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:49:10
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 440243)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:49:10
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 440244)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:49:10
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 440245)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=0.530
[ECRL][fail-inject] step=800 close_done_sec=0.608
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:50:39.919000 440739 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 440753 closing signal SIGTERM
W0216 22:50:39.920000 440739 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 440755 closing signal SIGTERM
W0216 22:50:39.920000 440739 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 440756 closing signal SIGTERM
E0216 22:50:40.051000 440739 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 440754) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:50:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 440753)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:50:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 440755)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:50:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 440756)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:50:39
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 440754)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=0.581
[ECRL][fail-inject] step=1400 close_done_sec=0.594
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:51:28.330000 441114 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 441122 closing signal SIGTERM
W0216 22:51:28.330000 441114 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 441123 closing signal SIGTERM
E0216 22:51:28.445000 441114 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 441124) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:51:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 441125)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:51:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 441122)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:51:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 441123)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:51:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 441124)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.021107204142026603,
    "stall_time_sec_total": 11.81745265214704,
    "write_time_sec_total": 11.735880190157332
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 14.49351535950428,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 120.70221304893494,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771253235.5158536
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 110.39419770240784
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.02175330906175077,
    "stall_time_sec_total": 11.603353627491742,
    "write_time_sec_total": 11.520896380883642
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.391878567653333,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 139.4716248512268,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771253376.8348455
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 129.1168236732483
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.284604124724865e-05,
    "enqueue_latency_sec_total": 4.182141004013829,
    "num_events": 35,
    "snapshot_time_sec_total": 0.022145412280224264,
    "stall_time_sec_total": 5.740404623909853,
    "write_time_sec_total": 0.9359078268753365
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.957000651674218,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 134.75430870056152,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771253513.4687917
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 123.48536849021912
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 213.5945194363594,
    "max_abs_diff": 3.699127197265625,
    "mean_abs_diff": 0.13351021502166988,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "04734478e2ff616405e24be79559a685f087c7512838f23ec135fc8fcebb8df6",
      "l2_distance": 302.06175187913203,
      "reference_digest": "cc1053d8f7f1d71777ee4b678784be7197f138fb8e776c286e0559cbfdcaab1d"
    },
    "1600": {
      "available": true,
      "candidate_digest": "56f90a0c054d984f05092364a0a74ad745bcb76bfe58fc8cd82bff55c39bcf2c",
      "l2_distance": 278.0931521801889,
      "reference_digest": "eab35f99a336070d4829a6643e72694de913d89e317bc4afe0a16163b4115b39"
    },
    "200": {
      "available": true,
      "candidate_digest": "b10fcb1cbe693019330cddd543f2841201156fa535ba8555bc597c4e44664620",
      "l2_distance": 1460.8424460343356,
      "reference_digest": "9714c2e214ded4f90c7651621e5a4a9e5a2890ad5c22df693150da1e22eaf5e2"
    },
    "400": {
      "available": true,
      "candidate_digest": "ee2c5a2a241c5fc46b8b97fac394ff2386026d582edeffe306f99d8d6a9534cd",
      "l2_distance": 866.3997110760617,
      "reference_digest": "772adccd5bd03774a2bec7e608c59bcf5a9a165fda0178682849d44c937b789a"
    },
    "800": {
      "available": true,
      "candidate_digest": "d090febd89cfe971b5859c1164cb96cf195cc5190d1ccf20b200c06480e435c9",
      "l2_distance": 424.25890108323955,
      "reference_digest": "4dec667709c282fdd52ffb3f229a72764e893befeebfee6e282aaacf63675353"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 152.63746058940887,
    "max_abs_diff": 1.7123212814331055,
    "mean_abs_diff": 0.0954170724004507,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "fe92407552c82b69f3e97feb766b990a4e8683ac7deb10fd351f360d1f5dcff8",
      "l2_distance": 241.89202674691103,
      "reference_digest": "cc1053d8f7f1d71777ee4b678784be7197f138fb8e776c286e0559cbfdcaab1d"
    },
    "1600": {
      "available": true,
      "candidate_digest": "bdfd1925fefa25e2f64d38cc03986a12e4023bfb564f0e643183ad7ec92eea7d",
      "l2_distance": 216.67883270977737,
      "reference_digest": "eab35f99a336070d4829a6643e72694de913d89e317bc4afe0a16163b4115b39"
    },
    "200": {
      "available": true,
      "candidate_digest": "085c893d6c7f5874d63e44c3dbcd04b75c55cba58f663912dbad1ac1b3d68be8",
      "l2_distance": 1424.5891209705528,
      "reference_digest": "9714c2e214ded4f90c7651621e5a4a9e5a2890ad5c22df693150da1e22eaf5e2"
    },
    "400": {
      "available": true,
      "candidate_digest": "c29a5d6687e726b42499ac7465621bd06dad72a220168cfd56b13f29f820bd0b",
      "l2_distance": 826.1681279320549,
      "reference_digest": "772adccd5bd03774a2bec7e608c59bcf5a9a165fda0178682849d44c937b789a"
    },
    "800": {
      "available": true,
      "candidate_digest": "c2b403dad8960de279c82a406d1ec562904155186d766cf199875fb10f4d0f44",
      "l2_distance": 355.4078261953681,
      "reference_digest": "4dec667709c282fdd52ffb3f229a72764e893befeebfee6e282aaacf63675353"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_reference seed=4242 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking seed=4242 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0216 22:56:11.114000 443023 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 443058 closing signal SIGTERM
W0216 22:56:11.115000 443023 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 443059 closing signal SIGTERM
W0216 22:56:11.115000 443023 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 443061 closing signal SIGTERM
E0216 22:56:11.212000 443023 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 443060) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:56:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 443058)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:56:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 443059)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:56:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 443061)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:56:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 443060)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0216 22:57:03.540000 443623 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 443640 closing signal SIGTERM
W0216 22:57:03.541000 443623 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 443642 closing signal SIGTERM
W0216 22:57:03.542000 443623 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 443643 closing signal SIGTERM
E0216 22:57:03.657000 443623 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 443641) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:57:03
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 443640)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:57:03
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 443642)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:57:03
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 443643)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:57:03
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 443641)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped seed=4242 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=0.570
[ECRL][fail-inject] step=800 close_done_sec=0.807
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:58:38.234000 444228 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 444236 closing signal SIGTERM
W0216 22:58:38.235000 444228 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 444237 closing signal SIGTERM
W0216 22:58:38.235000 444228 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 444239 closing signal SIGTERM
E0216 22:58:38.382000 444228 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 444238) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:58:38
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 444236)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:58:38
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 444237)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:58:38
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 444239)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:58:38
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 444238)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=0.582
[ECRL][fail-inject] step=1400 close_done_sec=0.729
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 22:59:31.601000 444668 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 444685 closing signal SIGTERM
W0216 22:59:31.601000 444668 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 444686 closing signal SIGTERM
W0216 22:59:31.602000 444668 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 444687 closing signal SIGTERM
E0216 22:59:31.733000 444668 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 444688) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_22:59:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 444685)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_22:59:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 444686)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_22:59:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 444687)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_22:59:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 444688)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.022286416264250875,
    "stall_time_sec_total": 17.776022415957414,
    "write_time_sec_total": 17.656449676142074
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.831313996350891,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 126.11675930023193,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771253699.8494484
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 115.67953705787659
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.023987546330317855,
    "stall_time_sec_total": 13.630213758093305,
    "write_time_sec_total": 13.475941326934844
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 11.614633686511517,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 148.3055510520935,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771253850.0313861
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 137.75725030899048
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.335000317543745e-05,
    "enqueue_latency_sec_total": 6.764253374771215,
    "num_events": 35,
    "snapshot_time_sec_total": 0.02438783273100853,
    "stall_time_sec_total": 8.309152998030186,
    "write_time_sec_total": 0.9218341109808534
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 11.771754836059428,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 148.01648569107056,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771253999.8965056
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 135.91856288909912
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 169.2219313979149,
    "max_abs_diff": 2.17474365234375,
    "mean_abs_diff": 0.10577548552304507,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "2cc2a3cf4a888eada792ab520e474aef146a8885ae89031dab7fc912f96fd5d9",
      "l2_distance": 328.66473620851957,
      "reference_digest": "7a25568155f766519d79a1aff591e93654ccb740c6df653255bf873b3d9fa26b"
    },
    "1600": {
      "available": true,
      "candidate_digest": "10f67e9aa7dc0a67b1e44bdafd357ade748c7697d2b686d1701f478a4013d0de",
      "l2_distance": 304.2548847869946,
      "reference_digest": "0c36f114f6518d954c14cdee22fdacbbcae266b44b0827fed3a2f401c2b04fc0"
    },
    "200": {
      "available": true,
      "candidate_digest": "bf0c174eaa838876b4446484b2916347c377b4fef5a51e764612dfbf7790287d",
      "l2_distance": 1349.3804953142064,
      "reference_digest": "36333ccd8af49b6f1f3634e59db652a53d01fcc19235e9a490632bfb3257be36"
    },
    "400": {
      "available": true,
      "candidate_digest": "49e515ce50f4096125df244a9205a4599bd4ba145143c527bad8cb2c9b667b4e",
      "l2_distance": 864.3661406559115,
      "reference_digest": "cbbbe7ad63317d81abf2fa01998fb27801521d60b460f389ef9d89fc11c75e97"
    },
    "800": {
      "available": true,
      "candidate_digest": "0417a2d1469b07038070a031bc48525e4482a42108ffc0233ccf017244b86d53",
      "l2_distance": 457.425367647506,
      "reference_digest": "7f7e50a8c9a5df8652e308dfcfb8d4c5441f1ee9fadc1decaf97dc62a90eb564"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 163.98044574260712,
    "max_abs_diff": 1.328704833984375,
    "mean_abs_diff": 0.10249582938849926,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "1862e6107cb020cbda52d331588ee2b42b7ed292d3f5599ab270a8e2238f6826",
      "l2_distance": 202.8158250957783,
      "reference_digest": "7a25568155f766519d79a1aff591e93654ccb740c6df653255bf873b3d9fa26b"
    },
    "1600": {
      "available": true,
      "candidate_digest": "409c25bedf32589085df0b754211622c57dce0275aa7460ba9944597e340a747",
      "l2_distance": 185.9289241821426,
      "reference_digest": "0c36f114f6518d954c14cdee22fdacbbcae266b44b0827fed3a2f401c2b04fc0"
    },
    "200": {
      "available": true,
      "candidate_digest": "de57e7f27639343b0dc341d56b9f058c4ea739a23017daa676701ba6787a996e",
      "l2_distance": 1159.0782736752271,
      "reference_digest": "36333ccd8af49b6f1f3634e59db652a53d01fcc19235e9a490632bfb3257be36"
    },
    "400": {
      "available": true,
      "candidate_digest": "a9b4fea32e1c6558061001f58de757b92438c3cb7eb04bb2e867e9211c88638d",
      "l2_distance": 670.5895881271811,
      "reference_digest": "cbbbe7ad63317d81abf2fa01998fb27801521d60b460f389ef9d89fc11c75e97"
    },
    "800": {
      "available": true,
      "candidate_digest": "0e72eb4edc3238d2f0144f496426c3f374becd52f196fbf64793684f9f3362bd",
      "l2_distance": 304.14670320684525,
      "reference_digest": "7f7e50a8c9a5df8652e308dfcfb8d4c5441f1ee9fadc1decaf97dc62a90eb564"
    }
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.83518009279848,
    "mean": 14.543241583255133,
    "n": 3,
    "std": 0.7380481398964578
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_reference",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_reference",
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_reference",
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_reference"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 15.304895393910227,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_reference",
      "snapshot_time_sec_total": 0.020832865266129375,
      "stall_time_sec_total": 11.260528670274653,
      "wall_clock_time_sec": 104.54171419143677,
      "write_time_sec_total": 11.176854046992958
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 14.49351535950428,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_reference",
      "snapshot_time_sec_total": 0.021107204142026603,
      "stall_time_sec_total": 11.81745265214704,
      "wall_clock_time_sec": 110.39419770240784,
      "write_time_sec_total": 11.735880190157332
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.831313996350891,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_reference",
      "snapshot_time_sec_total": 0.022286416264250875,
      "stall_time_sec_total": 17.776022415957414,
      "wall_clock_time_sec": 115.67953705787659,
      "write_time_sec_total": 17.656449676142074
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0008739311510516823,
    "mean": 0.02140882855746895,
    "n": 3,
    "std": 0.0007722924264993188
  },
  "stall_time_sec_total": {
    "ci95": 4.087026307840709,
    "mean": 13.618001246126369,
    "n": 3,
    "std": 3.611702661760585
  },
  "wall_clock_time_sec": {
    "ci95": 6.304539274736932,
    "mean": 110.20514965057373,
    "n": 3,
    "std": 5.571317521509084
  },
  "write_time_sec_total": {
    "ci95": 4.063050867899935,
    "mean": 13.523061304430788,
    "n": 3,
    "std": 3.590515580071178
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.8048077695245875,
    "mean": 12.347150302578433,
    "n": 3,
    "std": 0.7112081362973309
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_failure_blocking",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking",
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking",
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.034938653570444,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking",
      "snapshot_time_sec_total": 0.024656069930642843,
      "stall_time_sec_total": 11.642468529753387,
      "wall_clock_time_sec": 122.74702954292297,
      "write_time_sec_total": 11.555210054852068
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 12.391878567653333,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking",
      "snapshot_time_sec_total": 0.02175330906175077,
      "stall_time_sec_total": 11.603353627491742,
      "wall_clock_time_sec": 129.1168236732483,
      "write_time_sec_total": 11.520896380883642
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 11.614633686511517,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking",
      "snapshot_time_sec_total": 0.023987546330317855,
      "stall_time_sec_total": 13.630213758093305,
      "wall_clock_time_sec": 137.75725030899048,
      "write_time_sec_total": 13.475941326934844
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0017201883693450785,
    "mean": 0.023465641774237156,
    "n": 3,
    "std": 0.0015201294154564967
  },
  "stall_time_sec_total": {
    "ci95": 1.3116244774508206,
    "mean": 12.292011971779479,
    "n": 3,
    "std": 1.1590817527529593
  },
  "wall_clock_time_sec": {
    "ci95": 8.525161103216218,
    "mean": 129.87370117505392,
    "n": 3,
    "std": 7.533679680347159
  },
  "write_time_sec_total": {
    "ci95": 1.2662357470532266,
    "mean": 12.184015920890184,
    "n": 3,
    "std": 1.1189717593143478
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.8690502891401961,
    "mean": 12.646388475870133,
    "n": 3,
    "std": 0.767979211797573
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_failure_overlapped",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.210409939876754,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped",
      "snapshot_time_sec_total": 0.02546488679945469,
      "stall_time_sec_total": 5.940359962056391,
      "wall_clock_time_sec": 121.11660480499268,
      "write_time_sec_total": 0.8786803450202569
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 12.957000651674218,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped",
      "snapshot_time_sec_total": 0.022145412280224264,
      "stall_time_sec_total": 5.740404623909853,
      "wall_clock_time_sec": 123.48536849021912,
      "write_time_sec_total": 0.9359078268753365
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 11.771754836059428,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped",
      "snapshot_time_sec_total": 0.02438783273100853,
      "stall_time_sec_total": 8.309152998030186,
      "wall_clock_time_sec": 135.91856288909912,
      "write_time_sec_total": 0.9218341109808534
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0019163618742904156,
    "mean": 0.02399937727022916,
    "n": 3,
    "std": 0.001693487822428021
  },
  "stall_time_sec_total": {
    "ci95": 1.6168931397818778,
    "mean": 6.663305861332144,
    "n": 3,
    "std": 1.428847483934581
  },
  "wall_clock_time_sec": {
    "ci95": 8.997200943901111,
    "mean": 126.84017872810364,
    "n": 3,
    "std": 7.950821000379277
  },
  "write_time_sec_total": {
    "ci95": 0.03374421342590529,
    "mean": 0.9121407609588156,
    "n": 3,
    "std": 0.02981974087505909
  }
}
{
  "markdown": "results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_publishable.md",
  "json": "results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_publishable.json"
}
[INFO] Cleaning checkpoints for completed runs...
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s1337_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s2027_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_s4242_failure_overlapped
[DONE] Publishable markdown: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_publishable.md
[DONE] Publishable json: results/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4_publishable.json
[MATRIX 3/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4 dataset=cifar10 model=resnet50 fail=400,1200 k=50 inflight=4 port_base=39901
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar10 (size=50000)
[INFO] Model: resnet50
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0216 23:05:19.196000 447202 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 447212 closing signal SIGTERM
W0216 23:05:19.197000 447202 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 447215 closing signal SIGTERM
E0216 23:05:19.312000 447202 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 447213) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_23:05:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 447214)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_23:05:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 447212)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_23:05:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 447215)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_23:05:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 447213)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0216 23:07:07.745000 447777 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 447785 closing signal SIGTERM
W0216 23:07:07.746000 447777 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 447786 closing signal SIGTERM
W0216 23:07:07.746000 447777 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 447788 closing signal SIGTERM
E0216 23:07:07.862000 447777 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 447787) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_23:07:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 447785)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_23:07:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 447786)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_23:07:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 447788)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_23:07:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 447787)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=1.057
[ECRL][fail-inject] step=400 close_done_sec=0.662
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 23:09:06.444000 449030 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 449041 closing signal SIGTERM
W0216 23:09:06.445000 449030 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 449042 closing signal SIGTERM
W0216 23:09:06.445000 449030 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 449043 closing signal SIGTERM
E0216 23:09:06.611000 449030 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 449040) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_23:09:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 449041)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_23:09:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 449042)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_23:09:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 449043)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_23:09:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 449040)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=1.078
[ECRL][fail-inject] step=1200 close_done_sec=0.667
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0216 23:10:51.973000 449310 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 449318 closing signal SIGTERM
W0216 23:10:51.974000 449310 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 449319 closing signal SIGTERM
E0216 23:10:52.039000 449310 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 449320) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_23:10:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 449321)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_23:10:52
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 449318)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_23:10:52
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 449319)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_23:10:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 449320)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03857831296045333,
    "stall_time_sec_total": 22.29532029980328,
    "write_time_sec_total": 22.194574421155266
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 9.153349754028785,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 186.093900680542,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771254260.8710055
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 174.7993950843811
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.04485418344847858,
    "stall_time_sec_total": 24.676329529844224,
    "write_time_sec_total": 24.478550149011426
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.423762208183157,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 226.98009490966797,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771254489.666398
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 215.52414464950562
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.4197041057050228e-05,
    "enqueue_latency_sec_total": 8.372796004172415,
    "num_events": 35,
    "snapshot_time_sec_total": 0.041049320716410875,
    "stall_time_sec_total": 10.457249505096115,
    "write_time_sec_total": 1.8617599880089983
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.693623372413279,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 221.81937265396118,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771254713.3498318
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 207.96443009376526
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 60.414974212646484,
    "max_abs_diff": 0.3082275390625,
    "mean_abs_diff": 0.03777170896530151,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "c659667ddec8e2be6af674c5bc981c3e28cc3ce45f5ac40c971c6162e7f640dd",
      "l2_distance": 352190.4983241771,
      "reference_digest": "3fe7bc8d03e82c168dd613e53b3f0c8063bbbeb5a4e2a73c14802cec1a4b1803"
    },
    "1600": {
      "available": true,
      "candidate_digest": "cdcb9382cebeaa5dfd832905a0ebb36edb291f9e99ed28930f9bf3ecec06f1f5",
      "l2_distance": 309525.9783558606,
      "reference_digest": "3beb79ce58fd69a3dadc65031b8ed808357a5b45f1191a9eca7e0630fca48c0d"
    },
    "200": {
      "available": true,
      "candidate_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221",
      "l2_distance": 0.0,
      "reference_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221"
    },
    "400": {
      "available": true,
      "candidate_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d",
      "l2_distance": 0.0,
      "reference_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d"
    },
    "800": {
      "available": true,
      "candidate_digest": "61ff5b9a71ed9b8171f3994176f6c3fa7dfa6c7a7faadabb9684732c7964b21d",
      "l2_distance": 463567.9933421553,
      "reference_digest": "ff6f24aaaaeff70352e4c4edae2496257d0fe3f13ea87f4e57ff4d14cac6114e"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 60.414974212646484,
    "max_abs_diff": 0.3082275390625,
    "mean_abs_diff": 0.03777170896530151,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "c659667ddec8e2be6af674c5bc981c3e28cc3ce45f5ac40c971c6162e7f640dd",
      "l2_distance": 352190.4983241771,
      "reference_digest": "3fe7bc8d03e82c168dd613e53b3f0c8063bbbeb5a4e2a73c14802cec1a4b1803"
    },
    "1600": {
      "available": true,
      "candidate_digest": "cdcb9382cebeaa5dfd832905a0ebb36edb291f9e99ed28930f9bf3ecec06f1f5",
      "l2_distance": 309525.9783558606,
      "reference_digest": "3beb79ce58fd69a3dadc65031b8ed808357a5b45f1191a9eca7e0630fca48c0d"
    },
    "200": {
      "available": true,
      "candidate_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221",
      "l2_distance": 0.0,
      "reference_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221"
    },
    "400": {
      "available": true,
      "candidate_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d",
      "l2_distance": 0.0,
      "reference_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d"
    },
    "800": {
      "available": true,
      "candidate_digest": "61ff5b9a71ed9b8171f3994176f6c3fa7dfa6c7a7faadabb9684732c7964b21d",
      "l2_distance": 463567.9933421553,
      "reference_digest": "ff6f24aaaaeff70352e4c4edae2496257d0fe3f13ea87f4e57ff4d14cac6114e"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0216 23:17:23.806000 451158 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 451168 closing signal SIGTERM
W0216 23:17:23.807000 451158 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 451169 closing signal SIGTERM
W0216 23:17:23.807000 451158 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 451170 closing signal SIGTERM
E0216 23:17:23.972000 451158 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 451171) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_23:17:23
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 451168)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_23:17:23
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 451169)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_23:17:23
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 451170)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_23:17:23
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 451171)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0216 23:19:11.420000 451404 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 451414 closing signal SIGTERM
W0216 23:19:11.421000 451404 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 451415 closing signal SIGTERM
W0216 23:19:11.421000 451404 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 451416 closing signal SIGTERM
E0216 23:19:11.567000 451404 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 451417) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-16_23:19:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 451414)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-16_23:19:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 451415)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-16_23:19:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 451416)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-16_23:19:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 451417)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=400,1200
