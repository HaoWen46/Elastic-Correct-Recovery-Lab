nohup: ignoring input
[INFO] Matrix prefix: exp4_matrix_20260216_221349
[INFO] Results root: results
[INFO] NPROC: 4
[INFO] PROFILE: small
[INFO] MODELS: resnet18,resnet50
[INFO] DATASETS: cifar10,cifar100
[INFO] FAILURE_SPECS: base:400,1200;late:800,1400
[INFO] CHECKPOINT_EVERY_CSV: 50
[INFO] MAX_INFLIGHT_CSV: 4
[INFO] SKIP_IF_EXISTS: 1
[INFO] RESUME_MATRIX: 1
[INFO] START_RESUME_LATEST: 1
[INFO] DELETE_CHECKPOINTS_ON_COMPLETE: 1
[INFO] DRY_RUN: 0
[INFO] Planned suites: 8
[INFO] Resume map from previous manifest: 2 completed suites
[MATRIX 1/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4 dataset=cifar10 model=resnet18 fail=400,1200 k=50 inflight=4 port_base=39671
[SKIP] previously completed suite: exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4
[MATRIX 2/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4 dataset=cifar10 model=resnet18 fail=800,1400 k=50 inflight=4 port_base=39721
[SKIP] previously completed suite: exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4
[MATRIX 3/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4 dataset=cifar10 model=resnet50 fail=400,1200 k=50 inflight=4 port_base=39771
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar10 (size=50000)
[INFO] Model: resnet50
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0217 00:16:24.211000 467447 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 467459 closing signal SIGTERM
W0217 00:16:24.212000 467447 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 467460 closing signal SIGTERM
W0217 00:16:24.213000 467447 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 467462 closing signal SIGTERM
E0217 00:16:24.328000 467447 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 467461) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:16:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 467459)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:16:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 467460)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:16:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 467462)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:16:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 467461)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0217 00:18:09.423000 467694 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 467704 closing signal SIGTERM
W0217 00:18:09.424000 467694 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 467706 closing signal SIGTERM
W0217 00:18:09.425000 467694 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 467707 closing signal SIGTERM
E0217 00:18:09.554000 467694 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 467705) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:18:09
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 467704)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:18:09
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 467706)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:18:09
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 467707)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:18:09
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 467705)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=1.029
[ECRL][fail-inject] step=400 close_done_sec=0.751
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 00:20:07.744000 468420 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 468430 closing signal SIGTERM
W0217 00:20:07.745000 468420 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 468431 closing signal SIGTERM
W0217 00:20:07.745000 468420 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 468432 closing signal SIGTERM
E0217 00:20:07.911000 468420 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 468433) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:20:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 468430)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:20:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 468431)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:20:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 468432)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:20:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 468433)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=1.138
[ECRL][fail-inject] step=1200 close_done_sec=0.741
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 00:21:51.513000 468754 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 468767 closing signal SIGTERM
W0217 00:21:51.514000 468754 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 468768 closing signal SIGTERM
E0217 00:21:51.610000 468754 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 468766) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:21:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 468769)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:21:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 468767)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:21:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 468768)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:21:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 468766)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.04099652206059545,
    "stall_time_sec_total": 22.97382234199904,
    "write_time_sec_total": 22.79605774662923
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.494206047771781,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 200.40038299560547,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771258526.1884825
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 188.36369061470032
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.042727833962999284,
    "stall_time_sec_total": 22.869703173986636,
    "write_time_sec_total": 22.684962268336676
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.597623655857883,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 222.83922910690308,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771258750.934549
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 210.5921630859375
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.1139043383300304e-05,
    "enqueue_latency_sec_total": 8.565752438968047,
    "num_events": 35,
    "snapshot_time_sec_total": 0.044290433754213154,
    "stall_time_sec_total": 10.761330199777149,
    "write_time_sec_total": 1.7322818811517209
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.7420288240093145,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 219.44348764419556,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771258972.3369195
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 206.66417503356934
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 60.414974212646484,
    "max_abs_diff": 0.3082275390625,
    "mean_abs_diff": 0.03777170896530151,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "c659667ddec8e2be6af674c5bc981c3e28cc3ce45f5ac40c971c6162e7f640dd",
      "l2_distance": 352190.4983241771,
      "reference_digest": "3fe7bc8d03e82c168dd613e53b3f0c8063bbbeb5a4e2a73c14802cec1a4b1803"
    },
    "1600": {
      "available": true,
      "candidate_digest": "cdcb9382cebeaa5dfd832905a0ebb36edb291f9e99ed28930f9bf3ecec06f1f5",
      "l2_distance": 309525.9783558606,
      "reference_digest": "3beb79ce58fd69a3dadc65031b8ed808357a5b45f1191a9eca7e0630fca48c0d"
    },
    "200": {
      "available": true,
      "candidate_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221",
      "l2_distance": 0.0,
      "reference_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221"
    },
    "400": {
      "available": true,
      "candidate_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d",
      "l2_distance": 0.0,
      "reference_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d"
    },
    "800": {
      "available": true,
      "candidate_digest": "61ff5b9a71ed9b8171f3994176f6c3fa7dfa6c7a7faadabb9684732c7964b21d",
      "l2_distance": 463567.9933421553,
      "reference_digest": "ff6f24aaaaeff70352e4c4edae2496257d0fe3f13ea87f4e57ff4d14cac6114e"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 60.414974212646484,
    "max_abs_diff": 0.3082275390625,
    "mean_abs_diff": 0.03777170896530151,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "c659667ddec8e2be6af674c5bc981c3e28cc3ce45f5ac40c971c6162e7f640dd",
      "l2_distance": 352190.4983241771,
      "reference_digest": "3fe7bc8d03e82c168dd613e53b3f0c8063bbbeb5a4e2a73c14802cec1a4b1803"
    },
    "1600": {
      "available": true,
      "candidate_digest": "cdcb9382cebeaa5dfd832905a0ebb36edb291f9e99ed28930f9bf3ecec06f1f5",
      "l2_distance": 309525.9783558606,
      "reference_digest": "3beb79ce58fd69a3dadc65031b8ed808357a5b45f1191a9eca7e0630fca48c0d"
    },
    "200": {
      "available": true,
      "candidate_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221",
      "l2_distance": 0.0,
      "reference_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221"
    },
    "400": {
      "available": true,
      "candidate_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d",
      "l2_distance": 0.0,
      "reference_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d"
    },
    "800": {
      "available": true,
      "candidate_digest": "61ff5b9a71ed9b8171f3994176f6c3fa7dfa6c7a7faadabb9684732c7964b21d",
      "l2_distance": 463567.9933421553,
      "reference_digest": "ff6f24aaaaeff70352e4c4edae2496257d0fe3f13ea87f4e57ff4d14cac6114e"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0217 00:28:26.539000 470699 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 470723 closing signal SIGTERM
W0217 00:28:26.540000 470699 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 470725 closing signal SIGTERM
E0217 00:28:26.621000 470699 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 470722) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:28:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 470724)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:28:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 470723)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:28:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 470725)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:28:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 470722)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0217 00:30:13.912000 470954 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 470958 closing signal SIGTERM
W0217 00:30:13.913000 470954 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 470959 closing signal SIGTERM
E0217 00:30:13.978000 470954 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 470960) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:30:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 470961)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:30:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 470958)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:30:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 470959)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:30:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 470960)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=1.154
[ECRL][fail-inject] step=400 close_done_sec=0.661
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 00:32:12.260000 471711 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 471723 closing signal SIGTERM
W0217 00:32:12.261000 471711 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 471724 closing signal SIGTERM
W0217 00:32:12.261000 471711 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 471725 closing signal SIGTERM
E0217 00:32:12.377000 471711 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 471726) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:32:12
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 471723)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:32:12
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 471724)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:32:12
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 471725)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:32:12
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 471726)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=1.210
[ECRL][fail-inject] step=1200 close_done_sec=0.675
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 00:33:54.465000 472004 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 472010 closing signal SIGTERM
W0217 00:33:54.466000 472004 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 472012 closing signal SIGTERM
W0217 00:33:54.467000 472004 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 472013 closing signal SIGTERM
E0217 00:33:54.598000 472004 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 472011) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:33:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 472010)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:33:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 472012)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:33:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 472013)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:33:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 472011)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03989153495058417,
    "stall_time_sec_total": 23.601244650548324,
    "write_time_sec_total": 23.406367240590043
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.367725159922236,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 203.47136926651,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771259247.7393038
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 191.2108690738678
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.0428854658966884,
    "stall_time_sec_total": 23.962840326013975,
    "write_time_sec_total": 23.771582311368547
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.499815236672231,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 225.76821947097778,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771259475.4256978
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 213.3385889530182
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.2637657821178436e-05,
    "enqueue_latency_sec_total": 7.121769222081639,
    "num_events": 35,
    "snapshot_time_sec_total": 0.04145361785776913,
    "stall_time_sec_total": 10.060247509391047,
    "write_time_sec_total": 1.9255991011159495
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.846742267436021,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 217.37838912010193,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771259694.7558134
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 203.90627670288086
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 64.94414186477661,
    "max_abs_diff": 0.2431793212890625,
    "mean_abs_diff": 0.04060718804597854,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "d4bed9ae74f56b106e0009b7434245e0547de7709b0dc8a99fbc790da91df599",
      "l2_distance": 5325.491136467003,
      "reference_digest": "c95408b18b4f36e2e42c9c3e5e4d9d5fcf5d8cb6396ab0b72eeb426b9f2f3b27"
    },
    "1600": {
      "available": true,
      "candidate_digest": "f20bd6120505daff69ab80a808412ff74564481f83a66ebf0099bc09ad16d7ef",
      "l2_distance": 4649.808921226387,
      "reference_digest": "4523c71ea6164d869caa8ff5c1ee81ef2114dd73c6a8510cf5e552b57a1bf913"
    },
    "200": {
      "available": true,
      "candidate_digest": "fc0d5e8453eeec74983077dd2661ce847ad1fec91f27b8258c0cc2083a999382",
      "l2_distance": 0.0,
      "reference_digest": "fc0d5e8453eeec74983077dd2661ce847ad1fec91f27b8258c0cc2083a999382"
    },
    "400": {
      "available": true,
      "candidate_digest": "015e31d1a92d5ecb564ff4ae63da849bbb1669b834173b44fa86979c4e48d179",
      "l2_distance": 0.0,
      "reference_digest": "015e31d1a92d5ecb564ff4ae63da849bbb1669b834173b44fa86979c4e48d179"
    },
    "800": {
      "available": true,
      "candidate_digest": "f2a40de6021e73211a196b2e35c95f6167ec4427df95267d9014e0bde36ce7a5",
      "l2_distance": 10627.886918977098,
      "reference_digest": "4eb216c8bd9f4aa10836b8bb775b9d023b63e86a33900f197bb2696e50a91525"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 64.94414186477661,
    "max_abs_diff": 0.2431793212890625,
    "mean_abs_diff": 0.04060718804597854,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "d4bed9ae74f56b106e0009b7434245e0547de7709b0dc8a99fbc790da91df599",
      "l2_distance": 5325.491136467003,
      "reference_digest": "c95408b18b4f36e2e42c9c3e5e4d9d5fcf5d8cb6396ab0b72eeb426b9f2f3b27"
    },
    "1600": {
      "available": true,
      "candidate_digest": "f20bd6120505daff69ab80a808412ff74564481f83a66ebf0099bc09ad16d7ef",
      "l2_distance": 4649.808921226387,
      "reference_digest": "4523c71ea6164d869caa8ff5c1ee81ef2114dd73c6a8510cf5e552b57a1bf913"
    },
    "200": {
      "available": true,
      "candidate_digest": "fc0d5e8453eeec74983077dd2661ce847ad1fec91f27b8258c0cc2083a999382",
      "l2_distance": 0.0,
      "reference_digest": "fc0d5e8453eeec74983077dd2661ce847ad1fec91f27b8258c0cc2083a999382"
    },
    "400": {
      "available": true,
      "candidate_digest": "015e31d1a92d5ecb564ff4ae63da849bbb1669b834173b44fa86979c4e48d179",
      "l2_distance": 0.0,
      "reference_digest": "015e31d1a92d5ecb564ff4ae63da849bbb1669b834173b44fa86979c4e48d179"
    },
    "800": {
      "available": true,
      "candidate_digest": "f2a40de6021e73211a196b2e35c95f6167ec4427df95267d9014e0bde36ce7a5",
      "l2_distance": 10627.886918977098,
      "reference_digest": "4eb216c8bd9f4aa10836b8bb775b9d023b63e86a33900f197bb2696e50a91525"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_reference seed=4242 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking seed=4242 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0217 00:40:25.200000 474794 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 474806 closing signal SIGTERM
E0217 00:40:25.265000 474794 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 474804) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:40:25
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 474805)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:40:25
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 474807)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:40:25
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 474806)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:40:25
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 474804)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0217 00:42:12.880000 475109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 475116 closing signal SIGTERM
W0217 00:42:12.881000 475109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 475118 closing signal SIGTERM
E0217 00:42:12.996000 475109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 475115) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:42:12
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 475117)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:42:12
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 475116)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:42:12
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 475118)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:42:12
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 475115)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped seed=4242 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=1.137
[ECRL][fail-inject] step=400 close_done_sec=0.717
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 00:44:11.369000 475823 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 475833 closing signal SIGTERM
W0217 00:44:11.370000 475823 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 475834 closing signal SIGTERM
W0217 00:44:11.370000 475823 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 475836 closing signal SIGTERM
E0217 00:44:11.536000 475823 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 475835) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:44:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 475833)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:44:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 475834)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:44:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 475836)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:44:11
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 475835)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=1.105
[ECRL][fail-inject] step=1200 close_done_sec=0.661
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 00:45:53.900000 476109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 476115 closing signal SIGTERM
W0217 00:45:53.901000 476109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 476116 closing signal SIGTERM
E0217 00:45:54.016000 476109 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 476113) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:45:53
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 476114)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:45:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 476115)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:45:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 476116)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:45:53
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 476113)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.04313026391901076,
    "stall_time_sec_total": 27.13512870192062,
    "write_time_sec_total": 26.963423323933966
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.394872894262758,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 203.1270055770874,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771259967.3770497
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 190.5925223827362
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.041475563892163336,
    "stall_time_sec_total": 25.11151446576696,
    "write_time_sec_total": 24.903049485990778
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.525664888917382,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 224.66309523582458,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771260193.8746793
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 212.6057994365692
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.298003528267145e-05,
    "enqueue_latency_sec_total": 7.786276456899941,
    "num_events": 35,
    "snapshot_time_sec_total": 0.04707301640883088,
    "stall_time_sec_total": 10.335571618867107,
    "write_time_sec_total": 1.7456722590140998
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.824862869172299,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 218.11347103118896,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771260413.7807162
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 204.4764268398285
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 90.27468132972717,
    "max_abs_diff": 7.78515625,
    "mean_abs_diff": 0.0564312507212162,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "ebc66132c33e54eecb867087f39bad3d845570b6c0b438b2b1daf63b1f68dff3",
      "l2_distance": 9181.212473110647,
      "reference_digest": "797503f85d2e199339784780d3d29285ae7de7d43f07542c176f7c6959bb14fa"
    },
    "1600": {
      "available": true,
      "candidate_digest": "60d574bf8eb241e7a419fe6002c30b09187a309b8a177cd8c18e158c2c9c7b67",
      "l2_distance": 10547.929589895748,
      "reference_digest": "82eb2b7b86d2a3c7758213f79de4896e4ab621f9083ea9a75113945778cfae5b"
    },
    "200": {
      "available": true,
      "candidate_digest": "b5a497388c2ad11b92d79b07c478e99b7104486e592bf6d66f70c51d132d1375",
      "l2_distance": 0.0,
      "reference_digest": "b5a497388c2ad11b92d79b07c478e99b7104486e592bf6d66f70c51d132d1375"
    },
    "400": {
      "available": true,
      "candidate_digest": "b6433435a762c822218041f8ba3c82d9426979b2c779136b840c45c75abd57b9",
      "l2_distance": 0.0,
      "reference_digest": "b6433435a762c822218041f8ba3c82d9426979b2c779136b840c45c75abd57b9"
    },
    "800": {
      "available": true,
      "candidate_digest": "8118c824533de38143aaee856731951471a90bc1b1ae9e1ccf00efc288312e76",
      "l2_distance": 11411.252351351712,
      "reference_digest": "6096f5508785e2799abdd9581f1c95bac16e146348117a5bae1f8908dfb73f9f"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 90.27468132972717,
    "max_abs_diff": 7.78515625,
    "mean_abs_diff": 0.0564312507212162,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "ebc66132c33e54eecb867087f39bad3d845570b6c0b438b2b1daf63b1f68dff3",
      "l2_distance": 9181.212473110647,
      "reference_digest": "797503f85d2e199339784780d3d29285ae7de7d43f07542c176f7c6959bb14fa"
    },
    "1600": {
      "available": true,
      "candidate_digest": "60d574bf8eb241e7a419fe6002c30b09187a309b8a177cd8c18e158c2c9c7b67",
      "l2_distance": 10547.929589895748,
      "reference_digest": "82eb2b7b86d2a3c7758213f79de4896e4ab621f9083ea9a75113945778cfae5b"
    },
    "200": {
      "available": true,
      "candidate_digest": "b5a497388c2ad11b92d79b07c478e99b7104486e592bf6d66f70c51d132d1375",
      "l2_distance": 0.0,
      "reference_digest": "b5a497388c2ad11b92d79b07c478e99b7104486e592bf6d66f70c51d132d1375"
    },
    "400": {
      "available": true,
      "candidate_digest": "b6433435a762c822218041f8ba3c82d9426979b2c779136b840c45c75abd57b9",
      "l2_distance": 0.0,
      "reference_digest": "b6433435a762c822218041f8ba3c82d9426979b2c779136b840c45c75abd57b9"
    },
    "800": {
      "available": true,
      "candidate_digest": "8118c824533de38143aaee856731951471a90bc1b1ae9e1ccf00efc288312e76",
      "l2_distance": 11411.252351351712,
      "reference_digest": "6096f5508785e2799abdd9581f1c95bac16e146348117a5bae1f8908dfb73f9f"
    }
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.07534818564318566,
    "mean": 8.418934700652258,
    "n": 3,
    "std": 0.06658514581231091
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_reference",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference",
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_reference"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.494206047771781,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference",
      "snapshot_time_sec_total": 0.04099652206059545,
      "stall_time_sec_total": 22.97382234199904,
      "wall_clock_time_sec": 188.36369061470032,
      "write_time_sec_total": 22.79605774662923
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.367725159922236,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference",
      "snapshot_time_sec_total": 0.03989153495058417,
      "stall_time_sec_total": 23.601244650548324,
      "wall_clock_time_sec": 191.2108690738678,
      "write_time_sec_total": 23.406367240590043
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.394872894262758,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_reference",
      "snapshot_time_sec_total": 0.04313026391901076,
      "stall_time_sec_total": 27.13512870192062,
      "wall_clock_time_sec": 190.5925223827362,
      "write_time_sec_total": 26.963423323933966
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.001863043674715141,
    "mean": 0.04133944031006346,
    "n": 3,
    "std": 0.0016463705619012494
  },
  "stall_time_sec_total": {
    "ci95": 2.5387051211531038,
    "mean": 24.570065231489327,
    "n": 3,
    "std": 2.2434521710573865
  },
  "wall_clock_time_sec": {
    "ci95": 1.6946709082146507,
    "mean": 190.0556940237681,
    "n": 3,
    "std": 1.4975796505799328
  },
  "write_time_sec_total": {
    "ci95": 2.5468296578490333,
    "mean": 24.388616103717748,
    "n": 3,
    "std": 2.2506318191927477
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.05735350498951996,
    "mean": 7.541034593815833,
    "n": 3,
    "std": 0.05068325746632841
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_failure_blocking",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking",
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking",
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.597623655857883,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking",
      "snapshot_time_sec_total": 0.042727833962999284,
      "stall_time_sec_total": 22.869703173986636,
      "wall_clock_time_sec": 210.5921630859375,
      "write_time_sec_total": 22.684962268336676
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.499815236672231,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking",
      "snapshot_time_sec_total": 0.0428854658966884,
      "stall_time_sec_total": 23.962840326013975,
      "wall_clock_time_sec": 213.3385889530182,
      "write_time_sec_total": 23.771582311368547
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.525664888917382,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking",
      "snapshot_time_sec_total": 0.041475563892163336,
      "stall_time_sec_total": 25.11151446576696,
      "wall_clock_time_sec": 212.6057994365692,
      "write_time_sec_total": 24.903049485990778
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0008742044112796711,
    "mean": 0.04236295458395034,
    "n": 3,
    "std": 0.0007725339063965454
  },
  "stall_time_sec_total": {
    "ci95": 1.2685538808517614,
    "mean": 23.981352655255858,
    "n": 3,
    "std": 1.1210202927417994
  },
  "wall_clock_time_sec": {
    "ci95": 1.6092812766550635,
    "mean": 212.17885049184164,
    "n": 3,
    "std": 1.422120885120345
  },
  "write_time_sec_total": {
    "ci95": 1.2550864918820324,
    "mean": 23.786531355232,
    "n": 3,
    "std": 1.1091191693025833
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.06250370777274163,
    "mean": 7.804544653539211,
    "n": 3,
    "std": 0.05523448853256441
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_failure_overlapped",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.7420288240093145,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped",
      "snapshot_time_sec_total": 0.044290433754213154,
      "stall_time_sec_total": 10.761330199777149,
      "wall_clock_time_sec": 206.66417503356934,
      "write_time_sec_total": 1.7322818811517209
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.846742267436021,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped",
      "snapshot_time_sec_total": 0.04145361785776913,
      "stall_time_sec_total": 10.060247509391047,
      "wall_clock_time_sec": 203.90627670288086,
      "write_time_sec_total": 1.9255991011159495
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.824862869172299,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped",
      "snapshot_time_sec_total": 0.04707301640883088,
      "stall_time_sec_total": 10.335571618867107,
      "wall_clock_time_sec": 204.4764268398285,
      "write_time_sec_total": 1.7456722590140998
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.003179523398199285,
    "mean": 0.04427235600693772,
    "n": 3,
    "std": 0.002809742892620006
  },
  "stall_time_sec_total": {
    "ci95": 0.3997072491423285,
    "mean": 10.385716442678435,
    "n": 3,
    "std": 0.3532210528918901
  },
  "wall_clock_time_sec": {
    "ci95": 1.6474701686927582,
    "mean": 205.0156261920929,
    "n": 3,
    "std": 1.4558683857805748
  },
  "write_time_sec_total": {
    "ci95": 0.12216155727335892,
    "mean": 1.8011844137605901,
    "n": 3,
    "std": 0.10795409384142499
  }
}
{
  "markdown": "results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_publishable.md",
  "json": "results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_publishable.json"
}
[INFO] Cleaning checkpoints for completed runs...
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s1337_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s2027_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_s4242_failure_overlapped
[DONE] Publishable markdown: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_publishable.md
[DONE] Publishable json: results/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4_publishable.json
[MATRIX 4/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4 dataset=cifar10 model=resnet50 fail=800,1400 k=50 inflight=4 port_base=39821
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar10 (size=50000)
[INFO] Model: resnet50
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0217 00:53:24.730000 478878 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 478886 closing signal SIGTERM
W0217 00:53:24.731000 478878 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 478887 closing signal SIGTERM
W0217 00:53:24.731000 478878 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 478888 closing signal SIGTERM
E0217 00:53:24.850000 478878 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 478889) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:53:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 478886)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:53:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 478887)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:53:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 478888)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:53:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 478889)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0217 00:54:47.878000 479282 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 479291 closing signal SIGTERM
W0217 00:54:47.878000 479282 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 479292 closing signal SIGTERM
W0217 00:54:47.879000 479282 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 479293 closing signal SIGTERM
E0217 00:54:48.025000 479282 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 479290) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:54:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 479291)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:54:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 479292)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:54:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 479293)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:54:47
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 479290)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=1.038
[ECRL][fail-inject] step=800 close_done_sec=0.614
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 00:57:06.602000 479851 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 479857 closing signal SIGTERM
W0217 00:57:06.603000 479851 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 479859 closing signal SIGTERM
E0217 00:57:06.700000 479851 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 479858) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:57:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 479860)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:57:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 479857)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:57:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 479859)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:57:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 479858)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=1.096
[ECRL][fail-inject] step=1400 close_done_sec=0.639
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 00:58:26.603000 480345 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 480354 closing signal SIGTERM
W0217 00:58:26.604000 480345 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 480357 closing signal SIGTERM
E0217 00:58:26.719000 480345 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 480355) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_00:58:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 480356)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_00:58:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 480354)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_00:58:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 480357)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_00:58:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 480355)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.04059781541582197,
    "stall_time_sec_total": 25.27779167809058,
    "write_time_sec_total": 25.08193872089032
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.41042224885622,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 202.3103482723236,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771260699.052694
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 190.2401511669159
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.04854235239326954,
    "stall_time_sec_total": 26.769303357461467,
    "write_time_sec_total": 26.543051770422608
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.516643315600337,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 224.54462385177612,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771260925.380144
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 212.86097168922424
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.145557664334774e-05,
    "enqueue_latency_sec_total": 6.85592140071094,
    "num_events": 35,
    "snapshot_time_sec_total": 0.03861341276206076,
    "stall_time_sec_total": 9.67032558855135,
    "write_time_sec_total": 1.763982482952997
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.897636472535745,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 215.9461009502411,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771261143.157701
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 202.59225726127625
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 39.36244201660156,
    "max_abs_diff": 0.21282958984375,
    "mean_abs_diff": 0.024609622955322267,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "5420098b0ad99ce76f90fdbdad4816cd0afe2544650abc23ef76a5cdc594dd08",
      "l2_distance": 63812.19660372568,
      "reference_digest": "3fe7bc8d03e82c168dd613e53b3f0c8063bbbeb5a4e2a73c14802cec1a4b1803"
    },
    "1600": {
      "available": true,
      "candidate_digest": "0b53db7cd90f90d7b35547a059989815a899daab6ac8a66801f17a98bd2befe3",
      "l2_distance": 54133.49077174656,
      "reference_digest": "3beb79ce58fd69a3dadc65031b8ed808357a5b45f1191a9eca7e0630fca48c0d"
    },
    "200": {
      "available": true,
      "candidate_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221",
      "l2_distance": 0.0,
      "reference_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221"
    },
    "400": {
      "available": true,
      "candidate_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d",
      "l2_distance": 0.0,
      "reference_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d"
    },
    "800": {
      "available": true,
      "candidate_digest": "ff6f24aaaaeff70352e4c4edae2496257d0fe3f13ea87f4e57ff4d14cac6114e",
      "l2_distance": 0.0,
      "reference_digest": "ff6f24aaaaeff70352e4c4edae2496257d0fe3f13ea87f4e57ff4d14cac6114e"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 39.36244201660156,
    "max_abs_diff": 0.21282958984375,
    "mean_abs_diff": 0.024609622955322267,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "5420098b0ad99ce76f90fdbdad4816cd0afe2544650abc23ef76a5cdc594dd08",
      "l2_distance": 63812.19660372568,
      "reference_digest": "3fe7bc8d03e82c168dd613e53b3f0c8063bbbeb5a4e2a73c14802cec1a4b1803"
    },
    "1600": {
      "available": true,
      "candidate_digest": "0b53db7cd90f90d7b35547a059989815a899daab6ac8a66801f17a98bd2befe3",
      "l2_distance": 54133.49077174656,
      "reference_digest": "3beb79ce58fd69a3dadc65031b8ed808357a5b45f1191a9eca7e0630fca48c0d"
    },
    "200": {
      "available": true,
      "candidate_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221",
      "l2_distance": 0.0,
      "reference_digest": "dc33ebdf4a7de1f8e268bff754c81cb91ee5e2983e48f417162eaebe04fe2221"
    },
    "400": {
      "available": true,
      "candidate_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d",
      "l2_distance": 0.0,
      "reference_digest": "e27704e1f55b1b37ca4aa7751105e967aba61ce6b927db346b9940a3c72ee99d"
    },
    "800": {
      "available": true,
      "candidate_digest": "ff6f24aaaaeff70352e4c4edae2496257d0fe3f13ea87f4e57ff4d14cac6114e",
      "l2_distance": 0.0,
      "reference_digest": "ff6f24aaaaeff70352e4c4edae2496257d0fe3f13ea87f4e57ff4d14cac6114e"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0217 01:05:17.347000 482655 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 482660 closing signal SIGTERM
W0217 01:05:17.348000 482655 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 482661 closing signal SIGTERM
W0217 01:05:17.349000 482655 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 482662 closing signal SIGTERM
E0217 01:05:17.509000 482655 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 482659) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:05:17
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 482660)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:05:17
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 482661)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:05:17
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 482662)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:05:17
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 482659)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0217 01:06:40.519000 483531 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 483545 closing signal SIGTERM
W0217 01:06:40.520000 483531 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 483546 closing signal SIGTERM
E0217 01:06:40.635000 483531 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 483547) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:06:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 483548)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:06:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 483545)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:06:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 483546)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:06:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 483547)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=1.153
[ECRL][fail-inject] step=800 close_done_sec=0.638
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:09:00.895000 484301 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 484327 closing signal SIGTERM
W0217 01:09:00.896000 484301 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 484329 closing signal SIGTERM
W0217 01:09:00.896000 484301 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 484330 closing signal SIGTERM
E0217 01:09:01.061000 484301 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 484328) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:09:01
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 484327)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:09:01
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 484329)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:09:01
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 484330)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:09:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 484328)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=1.235
[ECRL][fail-inject] step=1400 close_done_sec=0.699
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:10:19.566000 484770 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 484783 closing signal SIGTERM
W0217 01:10:19.567000 484770 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 484784 closing signal SIGTERM
W0217 01:10:19.567000 484770 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 484786 closing signal SIGTERM
E0217 01:10:19.715000 484770 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 484785) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:10:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 484783)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:10:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 484784)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:10:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 484786)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:10:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 484785)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03719725424889475,
    "stall_time_sec_total": 24.516787216765806,
    "write_time_sec_total": 24.33447806572076
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.42977701834835,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 201.3729374408722,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771261411.460932
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 189.80335974693298
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.0437111189821735,
    "stall_time_sec_total": 24.850533412885852,
    "write_time_sec_total": 24.650224736891687
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.532679149950953,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 224.0912561416626,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771261637.3852854
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 212.40782570838928
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.1718675270676613e-05,
    "enqueue_latency_sec_total": 7.183287885971367,
    "num_events": 35,
    "snapshot_time_sec_total": 0.04065860225819051,
    "stall_time_sec_total": 10.128279693890363,
    "write_time_sec_total": 1.8383970890427008
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.846320091160466,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 216.9862983226776,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771261856.419943
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 203.91724801063538
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 43.54498291015625,
    "max_abs_diff": 0.235137939453125,
    "mean_abs_diff": 0.02723102569580078,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "d488f3d222645261970d9ffbd8b42a1d6af287678076852bfe5d0e0c5589ae54",
      "l2_distance": 6415.381811721311,
      "reference_digest": "c95408b18b4f36e2e42c9c3e5e4d9d5fcf5d8cb6396ab0b72eeb426b9f2f3b27"
    },
    "1600": {
      "available": true,
      "candidate_digest": "5bf7db70d485234d6ca7a5c7c2a55c9e68de369bcf15fd50c093404b259f007f",
      "l2_distance": 3263.177897990683,
      "reference_digest": "4523c71ea6164d869caa8ff5c1ee81ef2114dd73c6a8510cf5e552b57a1bf913"
    },
    "200": {
      "available": true,
      "candidate_digest": "fc0d5e8453eeec74983077dd2661ce847ad1fec91f27b8258c0cc2083a999382",
      "l2_distance": 0.0,
      "reference_digest": "fc0d5e8453eeec74983077dd2661ce847ad1fec91f27b8258c0cc2083a999382"
    },
    "400": {
      "available": true,
      "candidate_digest": "015e31d1a92d5ecb564ff4ae63da849bbb1669b834173b44fa86979c4e48d179",
      "l2_distance": 0.0,
      "reference_digest": "015e31d1a92d5ecb564ff4ae63da849bbb1669b834173b44fa86979c4e48d179"
    },
    "800": {
      "available": true,
      "candidate_digest": "4eb216c8bd9f4aa10836b8bb775b9d023b63e86a33900f197bb2696e50a91525",
      "l2_distance": 0.0,
      "reference_digest": "4eb216c8bd9f4aa10836b8bb775b9d023b63e86a33900f197bb2696e50a91525"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 43.54498291015625,
    "max_abs_diff": 0.235137939453125,
    "mean_abs_diff": 0.02723102569580078,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "d488f3d222645261970d9ffbd8b42a1d6af287678076852bfe5d0e0c5589ae54",
      "l2_distance": 6415.381811721311,
      "reference_digest": "c95408b18b4f36e2e42c9c3e5e4d9d5fcf5d8cb6396ab0b72eeb426b9f2f3b27"
    },
    "1600": {
      "available": true,
      "candidate_digest": "5bf7db70d485234d6ca7a5c7c2a55c9e68de369bcf15fd50c093404b259f007f",
      "l2_distance": 3263.177897990683,
      "reference_digest": "4523c71ea6164d869caa8ff5c1ee81ef2114dd73c6a8510cf5e552b57a1bf913"
    },
    "200": {
      "available": true,
      "candidate_digest": "fc0d5e8453eeec74983077dd2661ce847ad1fec91f27b8258c0cc2083a999382",
      "l2_distance": 0.0,
      "reference_digest": "fc0d5e8453eeec74983077dd2661ce847ad1fec91f27b8258c0cc2083a999382"
    },
    "400": {
      "available": true,
      "candidate_digest": "015e31d1a92d5ecb564ff4ae63da849bbb1669b834173b44fa86979c4e48d179",
      "l2_distance": 0.0,
      "reference_digest": "015e31d1a92d5ecb564ff4ae63da849bbb1669b834173b44fa86979c4e48d179"
    },
    "800": {
      "available": true,
      "candidate_digest": "4eb216c8bd9f4aa10836b8bb775b9d023b63e86a33900f197bb2696e50a91525",
      "l2_distance": 0.0,
      "reference_digest": "4eb216c8bd9f4aa10836b8bb775b9d023b63e86a33900f197bb2696e50a91525"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_reference seed=4242 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking seed=4242 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0217 01:17:13.554000 486317 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 486326 closing signal SIGTERM
W0217 01:17:13.555000 486317 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 486327 closing signal SIGTERM
W0217 01:17:13.555000 486317 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 486328 closing signal SIGTERM
E0217 01:17:13.684000 486317 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 486325) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:17:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 486326)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:17:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 486327)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:17:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 486328)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:17:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 486325)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0217 01:18:36.104000 486719 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 486726 closing signal SIGTERM
W0217 01:18:36.105000 486719 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 486727 closing signal SIGTERM
W0217 01:18:36.105000 486719 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 486728 closing signal SIGTERM
E0217 01:18:36.234000 486719 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 486725) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:18:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 486726)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:18:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 486727)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:18:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 486728)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:18:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 486725)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped seed=4242 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=1.248
[ECRL][fail-inject] step=800 close_done_sec=0.692
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:20:54.474000 487233 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 487264 closing signal SIGTERM
W0217 01:20:54.474000 487233 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 487266 closing signal SIGTERM
W0217 01:20:54.475000 487233 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 487267 closing signal SIGTERM
E0217 01:20:54.590000 487233 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 487265) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:20:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 487264)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:20:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 487266)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:20:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 487267)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:20:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 487265)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=1.168
[ECRL][fail-inject] step=1400 close_done_sec=0.733
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:22:13.387000 487759 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 487765 closing signal SIGTERM
W0217 01:22:13.388000 487759 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 487766 closing signal SIGTERM
W0217 01:22:13.388000 487759 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 487768 closing signal SIGTERM
E0217 01:22:13.519000 487759 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 487767) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:22:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 487765)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:22:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 487766)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:22:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 487768)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:22:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 487767)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.04235590575262904,
    "stall_time_sec_total": 25.570911170332693,
    "write_time_sec_total": 25.371748643927276
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.396961150005206,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 202.86629629135132,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771262127.1360054
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 190.54512357711792
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03933458204846829,
    "stall_time_sec_total": 24.95745342434384,
    "write_time_sec_total": 24.76487091218587
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.558645781091166,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 223.47669959068298,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771262352.4111233
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 211.67812943458557
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.4982262402772903e-05,
    "enqueue_latency_sec_total": 7.365554558462463,
    "num_events": 35,
    "snapshot_time_sec_total": 0.04210998793132603,
    "stall_time_sec_total": 10.416775788064115,
    "write_time_sec_total": 1.8156128019327298
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 7.85989598385896,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 216.7700822353363,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771262571.2165055
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 203.565034866333
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 43.80375671386719,
    "max_abs_diff": 0.4620819091796875,
    "mean_abs_diff": 0.02739710807800293,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "6a94f62d012bf3949c7c8fc2b1b132306861773a0e8ce29e69686ff30045a68a",
      "l2_distance": 3952.190588569857,
      "reference_digest": "797503f85d2e199339784780d3d29285ae7de7d43f07542c176f7c6959bb14fa"
    },
    "1600": {
      "available": true,
      "candidate_digest": "af89b8f8fec70e4a7b109935bfc3d944927dc1f897f97eeebf27441694a04f17",
      "l2_distance": 6711.588897729294,
      "reference_digest": "82eb2b7b86d2a3c7758213f79de4896e4ab621f9083ea9a75113945778cfae5b"
    },
    "200": {
      "available": true,
      "candidate_digest": "b5a497388c2ad11b92d79b07c478e99b7104486e592bf6d66f70c51d132d1375",
      "l2_distance": 0.0,
      "reference_digest": "b5a497388c2ad11b92d79b07c478e99b7104486e592bf6d66f70c51d132d1375"
    },
    "400": {
      "available": true,
      "candidate_digest": "b6433435a762c822218041f8ba3c82d9426979b2c779136b840c45c75abd57b9",
      "l2_distance": 0.0,
      "reference_digest": "b6433435a762c822218041f8ba3c82d9426979b2c779136b840c45c75abd57b9"
    },
    "800": {
      "available": true,
      "candidate_digest": "6096f5508785e2799abdd9581f1c95bac16e146348117a5bae1f8908dfb73f9f",
      "l2_distance": 0.0,
      "reference_digest": "6096f5508785e2799abdd9581f1c95bac16e146348117a5bae1f8908dfb73f9f"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 43.80375671386719,
    "max_abs_diff": 0.4620819091796875,
    "mean_abs_diff": 0.02739710807800293,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "6a94f62d012bf3949c7c8fc2b1b132306861773a0e8ce29e69686ff30045a68a",
      "l2_distance": 3952.190588569857,
      "reference_digest": "797503f85d2e199339784780d3d29285ae7de7d43f07542c176f7c6959bb14fa"
    },
    "1600": {
      "available": true,
      "candidate_digest": "af89b8f8fec70e4a7b109935bfc3d944927dc1f897f97eeebf27441694a04f17",
      "l2_distance": 6711.588897729294,
      "reference_digest": "82eb2b7b86d2a3c7758213f79de4896e4ab621f9083ea9a75113945778cfae5b"
    },
    "200": {
      "available": true,
      "candidate_digest": "b5a497388c2ad11b92d79b07c478e99b7104486e592bf6d66f70c51d132d1375",
      "l2_distance": 0.0,
      "reference_digest": "b5a497388c2ad11b92d79b07c478e99b7104486e592bf6d66f70c51d132d1375"
    },
    "400": {
      "available": true,
      "candidate_digest": "b6433435a762c822218041f8ba3c82d9426979b2c779136b840c45c75abd57b9",
      "l2_distance": 0.0,
      "reference_digest": "b6433435a762c822218041f8ba3c82d9426979b2c779136b840c45c75abd57b9"
    },
    "800": {
      "available": true,
      "candidate_digest": "6096f5508785e2799abdd9581f1c95bac16e146348117a5bae1f8908dfb73f9f",
      "l2_distance": 0.0,
      "reference_digest": "6096f5508785e2799abdd9581f1c95bac16e146348117a5bae1f8908dfb73f9f"
    }
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.018666874970892814,
    "mean": 8.41238680573659,
    "n": 3,
    "std": 0.016495906055164367
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_reference",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_reference",
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_reference",
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_reference"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.41042224885622,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_reference",
      "snapshot_time_sec_total": 0.04059781541582197,
      "stall_time_sec_total": 25.27779167809058,
      "wall_clock_time_sec": 190.2401511669159,
      "write_time_sec_total": 25.08193872089032
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.42977701834835,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_reference",
      "snapshot_time_sec_total": 0.03719725424889475,
      "stall_time_sec_total": 24.516787216765806,
      "wall_clock_time_sec": 189.80335974693298,
      "write_time_sec_total": 24.33447806572076
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.396961150005206,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_reference",
      "snapshot_time_sec_total": 0.04235590575262904,
      "stall_time_sec_total": 25.570911170332693,
      "wall_clock_time_sec": 190.54512357711792,
      "write_time_sec_total": 25.371748643927276
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0029676865079976546,
    "mean": 0.04005032513911525,
    "n": 3,
    "std": 0.002622542761626836
  },
  "stall_time_sec_total": {
    "ci95": 0.6156993603612502,
    "mean": 25.121830021729693,
    "n": 3,
    "std": 0.5440931501700738
  },
  "wall_clock_time_sec": {
    "ci95": 0.42189565821969877,
    "mean": 190.19621149698892,
    "n": 3,
    "std": 0.37282893649450627
  },
  "write_time_sec_total": {
    "ci95": 0.6056328596183678,
    "mean": 24.929388476846118,
    "n": 3,
    "std": 0.5351973895878788
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.023985525407693106,
    "mean": 7.535989415547486,
    "n": 3,
    "std": 0.021195994210387075
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_failure_blocking",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking",
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking",
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.516643315600337,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking",
      "snapshot_time_sec_total": 0.04854235239326954,
      "stall_time_sec_total": 26.769303357461467,
      "wall_clock_time_sec": 212.86097168922424,
      "write_time_sec_total": 26.543051770422608
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.532679149950953,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking",
      "snapshot_time_sec_total": 0.0437111189821735,
      "stall_time_sec_total": 24.850533412885852,
      "wall_clock_time_sec": 212.40782570838928,
      "write_time_sec_total": 24.650224736891687
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.558645781091166,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking",
      "snapshot_time_sec_total": 0.03933458204846829,
      "stall_time_sec_total": 24.95745342434384,
      "wall_clock_time_sec": 211.67812943458557,
      "write_time_sec_total": 24.76487091218587
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.005211903483303102,
    "mean": 0.04386268447463711,
    "n": 3,
    "std": 0.004605755937360297
  },
  "stall_time_sec_total": {
    "ci95": 1.2201697629150818,
    "mean": 25.525763398230385,
    "n": 3,
    "std": 1.0782632771572411
  },
  "wall_clock_time_sec": {
    "ci95": 0.6753257563821043,
    "mean": 212.3156422773997,
    "n": 3,
    "std": 0.5967849600580034
  },
  "write_time_sec_total": {
    "ci95": 1.200949035041426,
    "mean": 25.319382473166723,
    "n": 3,
    "std": 1.06127793162886
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.030088891785255867,
    "mean": 7.867950849185057,
    "n": 3,
    "std": 0.02658953536505356
  },
  "label": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_failure_overlapped",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.897636472535745,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped",
      "snapshot_time_sec_total": 0.03861341276206076,
      "stall_time_sec_total": 9.67032558855135,
      "wall_clock_time_sec": 202.59225726127625,
      "write_time_sec_total": 1.763982482952997
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.846320091160466,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped",
      "snapshot_time_sec_total": 0.04065860225819051,
      "stall_time_sec_total": 10.128279693890363,
      "wall_clock_time_sec": 203.91724801063538,
      "write_time_sec_total": 1.8383970890427008
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 7.85989598385896,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped",
      "snapshot_time_sec_total": 0.04210998793132603,
      "stall_time_sec_total": 10.416775788064115,
      "wall_clock_time_sec": 203.565034866333,
      "write_time_sec_total": 1.8156128019327298
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0019878603891546973,
    "mean": 0.04046066765052577,
    "n": 3,
    "std": 0.00175667101651509
  },
  "stall_time_sec_total": {
    "ci95": 0.42595626298029265,
    "mean": 10.07179369016861,
    "n": 3,
    "std": 0.3764172904510393
  },
  "wall_clock_time_sec": {
    "ci95": 0.7766084670605848,
    "mean": 203.35818004608154,
    "n": 3,
    "std": 0.6862884298658743
  },
  "write_time_sec_total": {
    "ci95": 0.04314559905032972,
    "mean": 1.8059974579761426,
    "n": 3,
    "std": 0.03812773963171764
  }
}
{
  "markdown": "results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_publishable.md",
  "json": "results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_publishable.json"
}
[INFO] Cleaning checkpoints for completed runs...
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s1337_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s2027_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_s4242_failure_overlapped
[DONE] Publishable markdown: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_publishable.md
[DONE] Publishable json: results/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4_publishable.json
[MATRIX 5/8] run_prefix=exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4 dataset=cifar100 model=resnet18 fail=400,1200 k=50 inflight=4 port_base=39871
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar100 (size=50000)
[INFO] Model: resnet18
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0217 01:26:51.412000 489338 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 489350 closing signal SIGTERM
W0217 01:26:51.413000 489338 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 489351 closing signal SIGTERM
W0217 01:26:51.414000 489338 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 489352 closing signal SIGTERM
E0217 01:26:51.558000 489338 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 489353) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:26:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 489350)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:26:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 489351)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:26:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 489352)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:26:51
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 489353)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0217 01:27:59.413000 489518 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 489526 closing signal SIGTERM
W0217 01:27:59.414000 489518 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 489527 closing signal SIGTERM
W0217 01:27:59.414000 489518 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 489529 closing signal SIGTERM
E0217 01:27:59.545000 489518 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 489528) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:27:59
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 489526)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:27:59
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 489527)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:27:59
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 489529)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:27:59
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 489528)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=0.543
[ECRL][fail-inject] step=400 close_done_sec=0.689
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:29:19.815000 490007 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 490015 closing signal SIGTERM
W0217 01:29:19.816000 490007 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 490016 closing signal SIGTERM
W0217 01:29:19.816000 490007 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 490018 closing signal SIGTERM
E0217 01:29:19.981000 490007 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 490017) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:29:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 490015)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:29:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 490016)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:29:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 490018)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:29:19
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 490017)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=0.571
[ECRL][fail-inject] step=1200 close_done_sec=0.627
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:30:24.555000 490233 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 490241 closing signal SIGTERM
E0217 01:30:24.620000 490233 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 490239) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:30:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 490240)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:30:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 490242)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:30:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 490241)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:30:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 490239)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.01982858486007899,
    "stall_time_sec_total": 11.970925260451622,
    "write_time_sec_total": 11.848616301082075
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 14.485011961312798,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 121.27177715301514,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771262772.8284373
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 110.45900440216064
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.023316763807088137,
    "stall_time_sec_total": 13.100480759283528,
    "write_time_sec_total": 12.945834941230714
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 11.825940739685377,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 145.86412692070007,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771262920.5284498
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 135.29579043388367
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.0301551558077335e-05,
    "enqueue_latency_sec_total": 3.594762591877952,
    "num_events": 35,
    "snapshot_time_sec_total": 0.02416604827158153,
    "stall_time_sec_total": 5.208117748843506,
    "write_time_sec_total": 0.9724893050733954
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.242165724555777,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 143.01629614830017,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771263065.4420097
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 130.6958291530609
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 148.51892125606537,
    "max_abs_diff": 0.560546875,
    "mean_abs_diff": 0.09284530967473983,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "b460b7703f0da4684aff3006eb6eccc1175cf6d4675d6cd6811fa3ed73838dd3",
      "l2_distance": 132.9562629457337,
      "reference_digest": "c56f3e5f106f05e13db42cd57c2ca232841e99982ffeef89dd65bcea5687ee98"
    },
    "1600": {
      "available": true,
      "candidate_digest": "bf07f61da50dd8b2392e7803837e87061af2bc22be60c50f44ec332d6ebd2d1a",
      "l2_distance": 127.6413424322493,
      "reference_digest": "1785d2a242ede54554d22a163d088cfe2e4a91181e345a4d32ac9d14b04ca94f"
    },
    "200": {
      "available": true,
      "candidate_digest": "9261ad200a687d6c139f55155c4a5e1000a116ae6226195f18a20a00689ce659",
      "l2_distance": 321.732176083045,
      "reference_digest": "fd7c316a6742948126b426b73a9602fb23fc9603e6ca525de36fbfc0e1d47594"
    },
    "400": {
      "available": true,
      "candidate_digest": "ac5f0622a101b6f58fda3cb88948236fcd183f4acf4e1c967c604ff17c08daf2",
      "l2_distance": 213.0194510449571,
      "reference_digest": "7b6e7ae668d315118c440a894101443dde6f7ae5e3ac3bd30703171aa5119198"
    },
    "800": {
      "available": true,
      "candidate_digest": "35346395f9159798c232b172b7631d52239ff6cfd537bdbbbd0a64fe1ed5b3f7",
      "l2_distance": 147.8608105496677,
      "reference_digest": "d3b5de5f7f2fc27fa0eb057454e05cd3cb737ae3f05d518275b803e3a9161a72"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 156.71443676948547,
    "max_abs_diff": 0.567626953125,
    "mean_abs_diff": 0.09795560598373414,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "6d5bdae971bfdb197ede679db24ee9f0bb041f2887dcf728987cf0f1e1c0f0d7",
      "l2_distance": 102.69920694404016,
      "reference_digest": "c56f3e5f106f05e13db42cd57c2ca232841e99982ffeef89dd65bcea5687ee98"
    },
    "1600": {
      "available": true,
      "candidate_digest": "ad711b3bc9b9e7c95143f6809bb1ecc9f40e5ed5ab75de9b71be12396e5a3ae8",
      "l2_distance": 98.6973283017629,
      "reference_digest": "1785d2a242ede54554d22a163d088cfe2e4a91181e345a4d32ac9d14b04ca94f"
    },
    "200": {
      "available": true,
      "candidate_digest": "ba42777865e66867b1e14d1da151cf582dd6977a5148ec6c4f10c1bd56fa40b9",
      "l2_distance": 275.7830683420566,
      "reference_digest": "fd7c316a6742948126b426b73a9602fb23fc9603e6ca525de36fbfc0e1d47594"
    },
    "400": {
      "available": true,
      "candidate_digest": "9e93a43a3b76ff6cb66373e38c7d53c30477778be1c313aabc79f14ca675d9bc",
      "l2_distance": 172.92074650236987,
      "reference_digest": "7b6e7ae668d315118c440a894101443dde6f7ae5e3ac3bd30703171aa5119198"
    },
    "800": {
      "available": true,
      "candidate_digest": "b1cadd4930aac0661b575acc2c49975a4b086aacdb5dfe593b43378a97d7341b",
      "l2_distance": 119.87933713030736,
      "reference_digest": "d3b5de5f7f2fc27fa0eb057454e05cd3cb737ae3f05d518275b803e3a9161a72"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0217 01:34:53.707000 492055 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 492060 closing signal SIGTERM
W0217 01:34:53.708000 492055 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 492062 closing signal SIGTERM
W0217 01:34:53.708000 492055 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 492063 closing signal SIGTERM
E0217 01:34:53.874000 492055 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 492061) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:34:53
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 492060)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:34:53
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 492062)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:34:53
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 492063)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:34:53
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 492061)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0217 01:36:01.862000 492440 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 492447 closing signal SIGTERM
W0217 01:36:01.863000 492440 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 492448 closing signal SIGTERM
W0217 01:36:01.863000 492440 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 492449 closing signal SIGTERM
E0217 01:36:01.978000 492440 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 492446) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:36:01
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 492447)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:36:01
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 492448)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:36:01
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 492449)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:36:01
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 492446)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=0.573
[ECRL][fail-inject] step=400 close_done_sec=0.749
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:37:22.865000 493073 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 493086 closing signal SIGTERM
W0217 01:37:22.866000 493073 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 493087 closing signal SIGTERM
W0217 01:37:22.866000 493073 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 493089 closing signal SIGTERM
E0217 01:37:22.981000 493073 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 493088) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:37:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 493086)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:37:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 493087)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:37:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 493089)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:37:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 493088)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=0.580
[ECRL][fail-inject] step=1200 close_done_sec=0.765
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:38:28.869000 493526 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 493538 closing signal SIGTERM
W0217 01:38:28.870000 493526 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 493540 closing signal SIGTERM
W0217 01:38:28.871000 493526 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 493541 closing signal SIGTERM
E0217 01:38:28.986000 493526 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 493539) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:38:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 493538)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:38:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 493540)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:38:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 493541)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:38:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 493539)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.02159972779918462,
    "stall_time_sec_total": 12.577626585145481,
    "write_time_sec_total": 12.4418381099822
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.96786956806978,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 125.47206783294678,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771263254.5973375
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 114.5486068725586
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.025003181770443916,
    "stall_time_sec_total": 12.038322898675688,
    "write_time_sec_total": 11.889438743586652
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 11.79497921329528,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 146.65505075454712,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771263403.1389596
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 135.65093851089478
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.4033128283917904e-05,
    "enqueue_latency_sec_total": 3.9196215639822185,
    "num_events": 35,
    "snapshot_time_sec_total": 0.02352716203313321,
    "stall_time_sec_total": 5.290524049894884,
    "write_time_sec_total": 0.9802098700311035
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.058309047330294,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 145.14069175720215,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771263550.3138638
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 132.68858790397644
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 152.6440773010254,
    "max_abs_diff": 1.12664794921875,
    "mean_abs_diff": 0.0954332272708416,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "eeec34ccbd3b8cf91e83bab4340e38849c0c08ade567878621891139b4a1062f",
      "l2_distance": 103.06639122245373,
      "reference_digest": "6c4412d43791caa49139313f7256d808e7a0ef591a7d713c1a39f8b54aa17de7"
    },
    "1600": {
      "available": true,
      "candidate_digest": "2a1494d9f28799379469533d053e1c7b21210976632e31ac21be603c28ae68a2",
      "l2_distance": 100.23805567532347,
      "reference_digest": "1f7af3b1f46d748741f7e21abd1b10d2e19ceda76f5249f505d67c6974e0df6a"
    },
    "200": {
      "available": true,
      "candidate_digest": "af36e1bf0edf671f504395f16d54dba26e7d3f6ff84502e2338f1bfe8c361c31",
      "l2_distance": 300.52568018359494,
      "reference_digest": "7b70c74a3932708e6a065ead9273aa9f330b57d693a36a7d58c3fe3688ef8a56"
    },
    "400": {
      "available": true,
      "candidate_digest": "83c6ced308bc851d25915dd8d539e50f425232faf427b4c4c4695ca3b58a3d95",
      "l2_distance": 167.38221165120214,
      "reference_digest": "28a86cbb5f6ddda142634cb45b248cd08692dc9437c7e1f87550a7377c8e9e87"
    },
    "800": {
      "available": true,
      "candidate_digest": "de2fa2ebd3259765bbd27adf2576c44c348f389d5a617042294ecd6176e947b3",
      "l2_distance": 118.16848519636324,
      "reference_digest": "7b561a556acc79bcbc75d0707b04731c96282db6baed22c1830a4b36fd71ddb7"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 158.2637859582901,
    "max_abs_diff": 1.20721435546875,
    "mean_abs_diff": 0.09895836658775807,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "38c56333ca21b0a982c88c7e36afc6687f9e07553095f3a7e8def3b8edb98dcb",
      "l2_distance": 103.84037171948442,
      "reference_digest": "6c4412d43791caa49139313f7256d808e7a0ef591a7d713c1a39f8b54aa17de7"
    },
    "1600": {
      "available": true,
      "candidate_digest": "8c255bdcdd2d3501b087b39bcc741e393907af31378dc1ae82f4d7ba151c6367",
      "l2_distance": 100.61152432412418,
      "reference_digest": "1f7af3b1f46d748741f7e21abd1b10d2e19ceda76f5249f505d67c6974e0df6a"
    },
    "200": {
      "available": true,
      "candidate_digest": "2d11c2cc0c9f6d05b779871698f6366ff6c239c110fd13facd47e71bed111246",
      "l2_distance": 309.331710452591,
      "reference_digest": "7b70c74a3932708e6a065ead9273aa9f330b57d693a36a7d58c3fe3688ef8a56"
    },
    "400": {
      "available": true,
      "candidate_digest": "9b923fbce741d6b31ada796df46466a13c9f6994ed0ffa1a93a070b917be5f8c",
      "l2_distance": 169.02665363635788,
      "reference_digest": "28a86cbb5f6ddda142634cb45b248cd08692dc9437c7e1f87550a7377c8e9e87"
    },
    "800": {
      "available": true,
      "candidate_digest": "9ea1d9388846194c31b3598e2fea7877057151b19be8f036aa1e3e6a93d48185",
      "l2_distance": 117.65562994118854,
      "reference_digest": "7b561a556acc79bcbc75d0707b04731c96282db6baed22c1830a4b36fd71ddb7"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_reference seed=4242 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking seed=4242 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0217 01:43:07.115000 495102 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 495109 closing signal SIGTERM
E0217 01:43:07.180000 495102 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 495108) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:43:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 495110)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:43:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 495111)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:43:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 495109)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:43:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 495108)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0217 01:44:15.279000 495301 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 495314 closing signal SIGTERM
E0217 01:44:15.344000 495301 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 495315) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:44:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 495316)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:44:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 495317)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:44:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 495314)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:44:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 495315)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped seed=4242 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=0.565
[ECRL][fail-inject] step=400 close_done_sec=0.749
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:45:36.235000 495839 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 495847 closing signal SIGTERM
W0217 01:45:36.235000 495839 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 495850 closing signal SIGTERM
E0217 01:45:36.316000 495839 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 495848) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:45:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 495849)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:45:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 495847)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:45:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 495850)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:45:36
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 495848)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=0.603
[ECRL][fail-inject] step=1200 close_done_sec=0.689
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:46:41.213000 496112 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 496118 closing signal SIGTERM
W0217 01:46:41.214000 496112 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 496120 closing signal SIGTERM
W0217 01:46:41.214000 496112 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 496121 closing signal SIGTERM
E0217 01:46:41.380000 496112 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 496119) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:46:41
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 496118)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:46:41
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 496120)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:46:41
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 496121)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:46:41
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 496119)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.021546348580159247,
    "stall_time_sec_total": 12.742015653755516,
    "write_time_sec_total": 12.607880740077235
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.865354983672374,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 127.05183744430542,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771263747.6929781
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 115.39553093910217
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.024643151904456317,
    "stall_time_sec_total": 12.468792516621761,
    "write_time_sec_total": 12.316513253725134
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 11.85065356153971,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 146.64284324645996,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771263896.2468433
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 135.01365065574646
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.2841966710984707e-05,
    "enqueue_latency_sec_total": 3.798380939173512,
    "num_events": 35,
    "snapshot_time_sec_total": 0.02482288342434913,
    "stall_time_sec_total": 5.299257607082836,
    "write_time_sec_total": 0.9723287059459835
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.17943045761423,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 143.3801989555359,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771264041.6120353
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 131.36903285980225
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 154.79257309436798,
    "max_abs_diff": 0.63818359375,
    "mean_abs_diff": 0.0967905443161726,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "62e66603148dd4e4f4e4671e597746e335b77ecb00092ba8e4ca39c8a696fa12",
      "l2_distance": 93.60143906575871,
      "reference_digest": "bc104f1396c920d6cd19d21a2e936b2726212b8ee9ff734baa20554ef0f72fee"
    },
    "1600": {
      "available": true,
      "candidate_digest": "f357d775ac41ed522b6fb839757fe46d1269d05865a09ae6608b6f56f84dfb20",
      "l2_distance": 91.17907881882913,
      "reference_digest": "97d02f41de05bd95955c40460269ee4d77427934402b636b66ec356f4d0ed30a"
    },
    "200": {
      "available": true,
      "candidate_digest": "5a20e916f622dac42283b073837d0cf6ee5e619b3b089f5253439ade5c632099",
      "l2_distance": 207.38520278437394,
      "reference_digest": "63e25f548a8f0ea18701dc9b129e64f874bc9ba8d65be9785c6e2b77a578aec6"
    },
    "400": {
      "available": true,
      "candidate_digest": "880de8f7f734a50f3b5e527ed857461725a1ddf2b4a5b560ecd93ca8db9dfe63",
      "l2_distance": 143.9731428229246,
      "reference_digest": "f805b3564f52ce9576216fbe976a8ed2d37edffee718eba80665d2cec5e69031"
    },
    "800": {
      "available": true,
      "candidate_digest": "cf5ed72583c9d45b7ecc2fd1f3213f1a3c0cc7e944165ac266124e4edc8d80be",
      "l2_distance": 106.02054081964917,
      "reference_digest": "baa2a1423ad74d3f13ab9366df418b5f5a55e519a19a368e132ec832ca526d20"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 145.85232603549957,
    "max_abs_diff": 0.55322265625,
    "mean_abs_diff": 0.09120330058038234,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "df5f863765ccc17369c496fb2e5f0be101bdcde4d1c1b7ba47d34d2bf74e77e1",
      "l2_distance": 101.4379244898312,
      "reference_digest": "bc104f1396c920d6cd19d21a2e936b2726212b8ee9ff734baa20554ef0f72fee"
    },
    "1600": {
      "available": true,
      "candidate_digest": "a1e0e471edc192499ebd063fbe96391be64a0e7136bfd456b42a973297fe631d",
      "l2_distance": 98.9170978807245,
      "reference_digest": "97d02f41de05bd95955c40460269ee4d77427934402b636b66ec356f4d0ed30a"
    },
    "200": {
      "available": true,
      "candidate_digest": "40016cce5045efd1b43d5ec980e3aacd9e857d4ca88d8bbb0ffbc45e6887e998",
      "l2_distance": 219.84661742685097,
      "reference_digest": "63e25f548a8f0ea18701dc9b129e64f874bc9ba8d65be9785c6e2b77a578aec6"
    },
    "400": {
      "available": true,
      "candidate_digest": "79ef8e0ee2974cedf3a27f832e399cd565299322a5660e2130ca3fedf074fc31",
      "l2_distance": 150.24540618016346,
      "reference_digest": "f805b3564f52ce9576216fbe976a8ed2d37edffee718eba80665d2cec5e69031"
    },
    "800": {
      "available": true,
      "candidate_digest": "5189b2f3a8f98eeb72d1fe936abe38fd8a12c8cc10419a4a9a3ce03ce2526f77",
      "l2_distance": 113.55782760829341,
      "reference_digest": "baa2a1423ad74d3f13ab9366df418b5f5a55e519a19a368e132ec832ca526d20"
    }
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.3758570125146653,
    "mean": 14.106078837684985,
    "n": 3,
    "std": 0.332144613294108
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_reference",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_reference",
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_reference",
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_reference"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 14.485011961312798,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_reference",
      "snapshot_time_sec_total": 0.01982858486007899,
      "stall_time_sec_total": 11.970925260451622,
      "wall_clock_time_sec": 110.45900440216064,
      "write_time_sec_total": 11.848616301082075
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.96786956806978,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_reference",
      "snapshot_time_sec_total": 0.02159972779918462,
      "stall_time_sec_total": 12.577626585145481,
      "wall_clock_time_sec": 114.5486068725586,
      "write_time_sec_total": 12.4418381099822
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.865354983672374,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_reference",
      "snapshot_time_sec_total": 0.021546348580159247,
      "stall_time_sec_total": 12.742015653755516,
      "wall_clock_time_sec": 115.39553093910217,
      "write_time_sec_total": 12.607880740077235
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.001140109614548795,
    "mean": 0.020991553746474285,
    "n": 3,
    "std": 0.001007514172753205
  },
  "stall_time_sec_total": {
    "ci95": 0.45958892450055655,
    "mean": 12.430189166450873,
    "n": 3,
    "std": 0.4061384529749493
  },
  "wall_clock_time_sec": {
    "ci95": 2.987220582558964,
    "mean": 113.4677140712738,
    "n": 3,
    "std": 2.639805011432462
  },
  "write_time_sec_total": {
    "ci95": 0.4516902954394879,
    "mean": 12.299445050380504,
    "n": 3,
    "std": 0.3991584392790764
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.03156679483476238,
    "mean": 11.823857838173454,
    "n": 3,
    "std": 0.027895557390771045
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_failure_blocking",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking",
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking",
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 11.825940739685377,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking",
      "snapshot_time_sec_total": 0.023316763807088137,
      "stall_time_sec_total": 13.100480759283528,
      "wall_clock_time_sec": 135.29579043388367,
      "write_time_sec_total": 12.945834941230714
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 11.79497921329528,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking",
      "snapshot_time_sec_total": 0.025003181770443916,
      "stall_time_sec_total": 12.038322898675688,
      "wall_clock_time_sec": 135.65093851089478,
      "write_time_sec_total": 11.889438743586652
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 11.85065356153971,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking",
      "snapshot_time_sec_total": 0.024643151904456317,
      "stall_time_sec_total": 12.468792516621761,
      "wall_clock_time_sec": 135.01365065574646,
      "write_time_sec_total": 12.316513253725134
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0010050437593449187,
    "mean": 0.024321032493996125,
    "n": 3,
    "std": 0.0008881565586813403
  },
  "stall_time_sec_total": {
    "ci95": 0.6045563876232922,
    "mean": 12.535865391526992,
    "n": 3,
    "std": 0.534246111940738
  },
  "wall_clock_time_sec": {
    "ci95": 0.36136740798952705,
    "mean": 135.3201265335083,
    "n": 3,
    "std": 0.31934015859047565
  },
  "write_time_sec_total": {
    "ci95": 0.6013526716241657,
    "mean": 12.383928979514167,
    "n": 3,
    "std": 0.531414990061397
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.10576071079195046,
    "mean": 12.159968409833434,
    "n": 3,
    "std": 0.09346067578380421
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_failure_overlapped",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 12.242165724555777,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped",
      "snapshot_time_sec_total": 0.02416604827158153,
      "stall_time_sec_total": 5.208117748843506,
      "wall_clock_time_sec": 130.6958291530609,
      "write_time_sec_total": 0.9724893050733954
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 12.058309047330294,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped",
      "snapshot_time_sec_total": 0.02352716203313321,
      "stall_time_sec_total": 5.290524049894884,
      "wall_clock_time_sec": 132.68858790397644,
      "write_time_sec_total": 0.9802098700311035
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 12.17943045761423,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped",
      "snapshot_time_sec_total": 0.02482288342434913,
      "stall_time_sec_total": 5.299257607082836,
      "wall_clock_time_sec": 131.36903285980225,
      "write_time_sec_total": 0.9723287059459835
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0007331468383075374,
    "mean": 0.02417203124302129,
    "n": 3,
    "std": 0.0006478814149781323
  },
  "stall_time_sec_total": {
    "ci95": 0.0569066970547092,
    "mean": 5.2659664686070755,
    "n": 3,
    "std": 0.05028841356616659
  },
  "wall_clock_time_sec": {
    "ci95": 1.147108610939414,
    "mean": 131.5844833056132,
    "n": 3,
    "std": 1.013699181605523
  },
  "write_time_sec_total": {
    "ci95": 0.0050973748023484,
    "mean": 0.9750092936834941,
    "n": 3,
    "std": 0.004504547011677956
  }
}
{
  "markdown": "results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_publishable.md",
  "json": "results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_publishable.json"
}
[INFO] Cleaning checkpoints for completed runs...
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s1337_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s2027_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_s4242_failure_overlapped
[DONE] Publishable markdown: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_publishable.md
[DONE] Publishable json: results/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4_publishable.json
[MATRIX 6/8] run_prefix=exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4 dataset=cifar100 model=resnet18 fail=800,1400 k=50 inflight=4 port_base=39921
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar100 (size=50000)
[INFO] Model: resnet18
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
W0217 01:49:51.948000 497072 .venv/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py:739] Received 1 death signal, shutting down workers
W0217 01:49:51.949000 497072 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 497080 closing signal SIGHUP
W0217 01:49:51.949000 497072 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 497081 closing signal SIGHUP
W0217 01:49:51.949000 497072 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 497082 closing signal SIGHUP
W0217 01:49:51.950000 497072 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 497083 closing signal SIGHUP
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 308, in launch_agent
    result = agent.run()
             ^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/metrics/api.py", line 134, in wrapper
    result = f(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py", line 731, in run
    result = self._invoke_run(role)
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/agent/server/api.py", line 908, in _invoke_run
    time.sleep(monitor_interval)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py", line 86, in _terminate_process_handler
    raise SignalException(f"Process {os.getpid()} got signal: {sigval}", sigval=sigval)
torch.distributed.elastic.multiprocessing.api.SignalException: Process 497072 got signal: 1
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference/step_00000850.pt global_step=850 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0217 01:52:06.842000 497710 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 497722 closing signal SIGTERM
W0217 01:52:06.843000 497710 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 497723 closing signal SIGTERM
E0217 01:52:06.908000 497710 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 497721) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:52:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 497724)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:52:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 497722)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:52:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 497723)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:52:06
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 497721)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0217 01:53:00.235000 497989 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 498006 closing signal SIGTERM
W0217 01:53:00.236000 497989 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 498009 closing signal SIGTERM
E0217 01:53:00.301000 497989 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 498007) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:53:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 498008)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:53:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 498006)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:53:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 498009)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:53:00
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 498007)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=0.584
[ECRL][fail-inject] step=800 close_done_sec=0.648
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:54:32.528000 498417 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 498425 closing signal SIGTERM
W0217 01:54:32.529000 498417 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 498427 closing signal SIGTERM
E0217 01:54:32.644000 498417 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 498426) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:54:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 498428)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:54:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 498425)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:54:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 498427)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:54:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 498426)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=0.547
[ECRL][fail-inject] step=1400 close_done_sec=0.613
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0217 01:55:24.371000 498694 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 498698 closing signal SIGTERM
W0217 01:55:24.371000 498694 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 498699 closing signal SIGTERM
W0217 01:55:24.372000 498694 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 498701 closing signal SIGTERM
E0217 01:55:24.519000 498694 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 498700) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-17_01:55:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 498698)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-17_01:55:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 498699)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-17_01:55:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 498701)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-17_01:55:24
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 498700)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.021902174106799066,
    "stall_time_sec_total": 12.017738608643413,
    "write_time_sec_total": 11.866649404983036
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.586438822422858,
  "replayed_steps": 29,
  "restarts": 1,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 2,
    "duration_sec": 137.70139813423157,
    "restarts": 1,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771264259.446023
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 127.12094521522522
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.023864516289904714,
    "stall_time_sec_total": 12.43552797101438,
    "write_time_sec_total": 12.278729554032907
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 11.918634264146178,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 144.9477562904358,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771264406.4185064
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 134.24356889724731
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.1762563847005367e-05,
    "enqueue_latency_sec_total": 3.5088046381715685,
    "num_events": 35,
    "snapshot_time_sec_total": 0.021740203956142068,
    "stall_time_sec_total": 5.112916032783687,
    "write_time_sec_total": 0.9712518050801009
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 12.172558704414138,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 143.1504819393158,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771264551.3941104
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 131.44319438934326
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 135.0893533229828,
    "max_abs_diff": 1.146240234375,
    "mean_abs_diff": 0.08444849140942097,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "cd3489533d4067524273f2d2c4f887443b1dc68ade4cea456225497264f66d1e",
      "l2_distance": 120.84909360585209,
      "reference_digest": "586cc06ac465cb4463556ae6754358485e0ffa45e3126d7c144e21ee5490ba32"
    },
    "1600": {
      "available": true,
      "candidate_digest": "7fcb21e0e6bedcf66109879750a1371c762cac82c530297d6f2237eeae948f4c",
      "l2_distance": 116.58529302151722,
      "reference_digest": "74c37e9331fb2d70d1118208199a8e829c532bc45aa2a474eb68f1ee1d5dd11c"
    },
    "200": {
      "available": true,
      "candidate_digest": "e29796e959b657c13792668bb170a85cde0c874b141af2a8411761f4a5af8f7c",
      "l2_distance": 367.14142407073047,
      "reference_digest": "3dbddc615a533868978daaa2a64cf892d62ca683b894c25c4a7b991ad7cfeb37"
    },
    "400": {
      "available": true,
      "candidate_digest": "4b4f93849b923489dbfaf3ce2b9d835ab0e24ea4aeb04fb0f6e5396dcea6b3a4",
      "l2_distance": 221.25764117643914,
      "reference_digest": "60173e562b828173b36c83acdd5ef2ffbaf335dc93c3305379c96108ca47e9db"
    },
    "800": {
      "available": true,
      "candidate_digest": "cb9968469149798e1746cb9de39c34ebe2e449750a6a723a7a409305882ebee0",
      "l2_distance": 137.32391224124194,
      "reference_digest": "e72a239b364ec26430c6f981bbe7451e9b37878145e27dce50870895c148d2b1"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 131.7801434993744,
    "max_abs_diff": 1.0284423828125,
    "mean_abs_diff": 0.08236923307180405,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "cb5714a48efa910496c8a725c941ad764dcfc0a940be246860615364b4468383",
      "l2_distance": 107.29381186005809,
      "reference_digest": "586cc06ac465cb4463556ae6754358485e0ffa45e3126d7c144e21ee5490ba32"
    },
    "1600": {
      "available": true,
      "candidate_digest": "e796b99e70d473e80e926c6d3dfb0eab322699aede6688fa6fcabd28edcb700b",
      "l2_distance": 102.63030743006325,
      "reference_digest": "74c37e9331fb2d70d1118208199a8e829c532bc45aa2a474eb68f1ee1d5dd11c"
    },
    "200": {
      "available": true,
      "candidate_digest": "2e317cf553524d7061692cbcd55f52896a89106ae49f864d1adf5a8ccf0eabd0",
      "l2_distance": 349.7443223863414,
      "reference_digest": "3dbddc615a533868978daaa2a64cf892d62ca683b894c25c4a7b991ad7cfeb37"
    },
    "400": {
      "available": true,
      "candidate_digest": "8d6afe7ab45d6da87010fbc4d8edb0a9ee26b6004c51adb2038d6a180c363848",
      "l2_distance": 201.24361855362272,
      "reference_digest": "60173e562b828173b36c83acdd5ef2ffbaf335dc93c3305379c96108ca47e9db"
    },
    "800": {
      "available": true,
      "candidate_digest": "80fa08cbea4b83dfe62a74da23fa535f5311f5b3c54c44a23e89905646862ccd",
      "l2_distance": 123.82214175123835,
      "reference_digest": "e72a239b364ec26430c6f981bbe7451e9b37878145e27dce50870895c148d2b1"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/ecrl/orchestration/supervisor.py", line 366, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/ecrl/orchestration/supervisor.py", line 331, in main
    raise RuntimeError(
RuntimeError: exceeded max restarts (20); last_step=1350
[ERROR] run exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4 failed with rc=1
[INFO] Manifest: results/exp4_matrix_20260216_221349_manifest.csv
