nohup: ignoring input
[INFO] Matrix prefix: exp4_matrix_20260216_221349
[INFO] Results root: results
[INFO] NPROC: 4
[INFO] PROFILE: small
[INFO] MODELS: resnet18,resnet50
[INFO] DATASETS: cifar10,cifar100
[INFO] FAILURE_SPECS: base:400,1200;late:800,1400
[INFO] CHECKPOINT_EVERY_CSV: 50
[INFO] MAX_INFLIGHT_CSV: 4
[INFO] SKIP_IF_EXISTS: 1
[INFO] RESUME_MATRIX: 1
[INFO] START_RESUME_LATEST: 1
[INFO] DELETE_CHECKPOINTS_ON_COMPLETE: 1
[INFO] DRY_RUN: 0
[INFO] Planned suites: 8
[INFO] Resume map from previous manifest: 5 completed suites
[MATRIX 1/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4 dataset=cifar10 model=resnet18 fail=400,1200 k=50 inflight=4 port_base=43559
[SKIP] previously completed suite: exp4_matrix_20260216_221349_cifar10_resnet18_fbase_k50_m4
[MATRIX 2/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4 dataset=cifar10 model=resnet18 fail=800,1400 k=50 inflight=4 port_base=43609
[SKIP] previously completed suite: exp4_matrix_20260216_221349_cifar10_resnet18_flate_k50_m4
[MATRIX 3/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4 dataset=cifar10 model=resnet50 fail=400,1200 k=50 inflight=4 port_base=43659
[SKIP] previously completed suite: exp4_matrix_20260216_221349_cifar10_resnet50_fbase_k50_m4
[MATRIX 4/8] run_prefix=exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4 dataset=cifar10 model=resnet50 fail=800,1400 k=50 inflight=4 port_base=43709
[SKIP] previously completed suite: exp4_matrix_20260216_221349_cifar10_resnet50_flate_k50_m4
[MATRIX 5/8] run_prefix=exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4 dataset=cifar100 model=resnet18 fail=400,1200 k=50 inflight=4 port_base=43759
[SKIP] previously completed suite: exp4_matrix_20260216_221349_cifar100_resnet18_fbase_k50_m4
[MATRIX 6/8] run_prefix=exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4 dataset=cifar100 model=resnet18 fail=800,1400 k=50 inflight=4 port_base=43809
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar100 (size=50000)
[INFO] Model: resnet18
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0218 04:29:21.460000 904985 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 904997 closing signal SIGTERM
W0218 04:29:21.461000 904985 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 904998 closing signal SIGTERM
W0218 04:29:21.461000 904985 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 904999 closing signal SIGTERM
E0218 04:29:21.608000 904985 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 905000) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:29:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 904997)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:29:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 904998)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:29:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 904999)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:29:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 905000)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0218 04:30:07.941000 905140 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 905153 closing signal SIGTERM
W0218 04:30:07.942000 905140 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 905154 closing signal SIGTERM
W0218 04:30:07.943000 905140 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 905155 closing signal SIGTERM
E0218 04:30:08.108000 905140 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 905152) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:30:08
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 905153)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:30:08
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 905154)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:30:08
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 905155)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:30:07
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 905152)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=0.500
[ECRL][fail-inject] step=800 close_done_sec=0.702
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 04:31:29.249000 905469 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 905479 closing signal SIGTERM
W0218 04:31:29.250000 905469 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 905482 closing signal SIGTERM
E0218 04:31:29.315000 905469 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 905480) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:31:29
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 905481)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:31:29
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 905479)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:31:29
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 905482)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:31:29
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 905480)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=0.605
[ECRL][fail-inject] step=1400 close_done_sec=0.653
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 04:32:15.477000 905627 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 905638 closing signal SIGTERM
W0218 04:32:15.478000 905627 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 905639 closing signal SIGTERM
W0218 04:32:15.478000 905627 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 905640 closing signal SIGTERM
E0218 04:32:15.601000 905627 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 905637) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:32:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 905638)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:32:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 905639)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:32:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 905640)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:32:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 905637)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.02648780809249729,
    "stall_time_sec_total": 11.252927842666395,
    "write_time_sec_total": 11.192500202683732
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 16.51578418383933,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 107.31912064552307,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771360103.8642764
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 96.8770227432251
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.020597569877281785,
    "stall_time_sec_total": 10.873723419615999,
    "write_time_sec_total": 10.8182362630032
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.760890713919324,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 126.14854693412781,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771360231.774648
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 116.27154326438904
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.116698306053877e-05,
    "enqueue_latency_sec_total": 3.4778067322913557,
    "num_events": 35,
    "snapshot_time_sec_total": 0.022668897872790694,
    "stall_time_sec_total": 5.007599964970723,
    "write_time_sec_total": 0.8999858919996768
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.890630531003355,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 126.22640681266785,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771360359.7740698
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 115.185555934906
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 147.09296000003815,
    "max_abs_diff": 0.64794921875,
    "mean_abs_diff": 0.09198894836008549,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "a77a7f9bcdfcb41aa0cbc989c8763c95e75d959d52fc7061a54dd157c13dd2a6",
      "l2_distance": 111.0250400527612,
      "reference_digest": "09d87270db4e34b14f8f11a763a684c7b95df403c047054442990114686f9189"
    },
    "1600": {
      "available": true,
      "candidate_digest": "ce874981b34413a97b5c79a7fa1432cabf045a7d168eebd2f4b8e5a03d5b6340",
      "l2_distance": 107.0330909467309,
      "reference_digest": "5bc08e7f76375f3168efc6280536dda20e8bf45419459dfb425c7fd28fb21436"
    },
    "200": {
      "available": true,
      "candidate_digest": "a02148bcae3c28aee4bd2bb4330e75d9a809318222e9287ef3a7d8d434ee0ffc",
      "l2_distance": 338.5403973050049,
      "reference_digest": "5be8a30413f95b3d745bc6b419cd145ea00c8f97fd7df62cfee8cbe396401c8e"
    },
    "400": {
      "available": true,
      "candidate_digest": "30ab4ab6be86c4f4c8edadfc5b589f8ca5c04a4f9676d806d02054f8cf2b8db5",
      "l2_distance": 193.7430672884211,
      "reference_digest": "ecc9eab54b6fd0b398628ca7731fb81f7b108e567ca374c9ae54ce5dd6ba3abe"
    },
    "800": {
      "available": true,
      "candidate_digest": "d06b54ae582c722ced08a3e1e2b5845e8640482da7d4a6e76ad5b2e81c3f1051",
      "l2_distance": 127.89657743250868,
      "reference_digest": "f8a08275bf9bbabee7abe59f95d063a0b9ae8f26fbf51b5199bc4853fb21439c"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 144.77606761455536,
    "max_abs_diff": 1.059814453125,
    "mean_abs_diff": 0.09049334868788719,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "ca46d05a5b77faffd4cbf0b0ed03ace89fa3c58e05982f751228df0a4f31b1d5",
      "l2_distance": 119.15079525285682,
      "reference_digest": "09d87270db4e34b14f8f11a763a684c7b95df403c047054442990114686f9189"
    },
    "1600": {
      "available": true,
      "candidate_digest": "6b3f6f5a075f46ec4aec42398b6f40b9b47d6742d898a8e4c27c9cb76158afdb",
      "l2_distance": 114.98055325162876,
      "reference_digest": "5bc08e7f76375f3168efc6280536dda20e8bf45419459dfb425c7fd28fb21436"
    },
    "200": {
      "available": true,
      "candidate_digest": "a91161adb193c549e3596c74e619c75c4b84d3039c7891a5e9dc389a7f983ede",
      "l2_distance": 321.20678233687676,
      "reference_digest": "5be8a30413f95b3d745bc6b419cd145ea00c8f97fd7df62cfee8cbe396401c8e"
    },
    "400": {
      "available": true,
      "candidate_digest": "736e57914c03b66e6dfa2050662a22433dfec46f113a9231a27a285b850140fd",
      "l2_distance": 192.58340111609118,
      "reference_digest": "ecc9eab54b6fd0b398628ca7731fb81f7b108e567ca374c9ae54ce5dd6ba3abe"
    },
    "800": {
      "available": true,
      "candidate_digest": "51b37e09d25494a82b1ca5c512d395362cf26582f4a073f8976455027b5253b2",
      "l2_distance": 132.15006846879024,
      "reference_digest": "f8a08275bf9bbabee7abe59f95d063a0b9ae8f26fbf51b5199bc4853fb21439c"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0218 04:36:26.873000 906948 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 906962 closing signal SIGTERM
W0218 04:36:26.874000 906948 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 906964 closing signal SIGTERM
E0218 04:36:26.939000 906948 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 906963) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:36:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 906965)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:36:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 906962)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:36:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 906964)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:36:26
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 906963)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0218 04:37:13.076000 907133 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 907146 closing signal SIGTERM
W0218 04:37:13.076000 907133 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 907147 closing signal SIGTERM
E0218 04:37:13.191000 907133 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 907145) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:37:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 907148)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:37:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 907146)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:37:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 907147)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:37:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 907145)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=0.536
[ECRL][fail-inject] step=800 close_done_sec=0.771
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 04:38:34.492000 907691 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 907701 closing signal SIGTERM
W0218 04:38:34.493000 907691 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 907702 closing signal SIGTERM
W0218 04:38:34.493000 907691 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 907704 closing signal SIGTERM
E0218 04:38:34.608000 907691 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 907703) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:38:34
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 907701)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:38:34
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 907702)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:38:34
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 907704)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:38:34
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 907703)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=0.484
[ECRL][fail-inject] step=1400 close_done_sec=0.592
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 04:39:20.134000 907858 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 907868 closing signal SIGTERM
W0218 04:39:20.135000 907858 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 907870 closing signal SIGTERM
E0218 04:39:20.250000 907858 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 907869) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:39:20
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 907871)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:39:20
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 907868)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:39:20
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 907870)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:39:20
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 907869)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.022590057458728552,
    "stall_time_sec_total": 11.069590437225997,
    "write_time_sec_total": 11.013480203226209
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 16.405262156970117,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 107.69372797012329,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771360528.0996692
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 97.52968192100525
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.02321662788745016,
    "stall_time_sec_total": 11.352042638813145,
    "write_time_sec_total": 11.29285556776449
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.694941497845901,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 126.93963885307312,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771360656.791104
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 116.83145928382874
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.13974853977561e-05,
    "enqueue_latency_sec_total": 3.431265984661877,
    "num_events": 35,
    "snapshot_time_sec_total": 0.023272038088180125,
    "stall_time_sec_total": 4.921978801256046,
    "write_time_sec_total": 0.8787611759034917
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.998415609515131,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 125.64883351325989,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771360784.3182714
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 114.29864954948425
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 135.87119317054749,
    "max_abs_diff": 0.8299560546875,
    "mean_abs_diff": 0.08496386729180813,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "35117ec360c9c374f28885fd328662197477a8d154033e675f20c5af7cd9a877",
      "l2_distance": 91.79984567924407,
      "reference_digest": "2e0b1065e28397742c3ab0b4d125830cdf8671c25e37983c86de3e19de4632f8"
    },
    "1600": {
      "available": true,
      "candidate_digest": "29b014939ac8105578167481912cc1db7e047fab1752a2e3f813c317f8f00f7f",
      "l2_distance": 89.20246390720244,
      "reference_digest": "2ec6053d5fe0eb5fcdfb77a61a34bd4c9de27078d5f6b8cf1b443cc94223d441"
    },
    "200": {
      "available": true,
      "candidate_digest": "99babcc22a29b5d55335d41ea9228b5fc0cb8c36104d34c242262ad8df57c52a",
      "l2_distance": 332.24127457286505,
      "reference_digest": "c879d42940fdb503db5e378da8dbbcb8f2da36bd172be792d036ce946a939a41"
    },
    "400": {
      "available": true,
      "candidate_digest": "ee64f71946aed9758b1de98de050658bd7e42746b2dbffeb08a20a5d0fc715da",
      "l2_distance": 164.38352877088624,
      "reference_digest": "b479cc44055b5c73dbb91aad92c9f608ef151e6fafec00708ac424e1a3b316d3"
    },
    "800": {
      "available": true,
      "candidate_digest": "853d43157793c51dcfbfb05bc4ad942db2572c6db18e1bb5ad1cbb00915df433",
      "l2_distance": 105.35682953064678,
      "reference_digest": "c4ead4876b21d4a20b5410d43e759544eb964fff37c2d562319efdbf4e5102f7"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 146.78768146038055,
    "max_abs_diff": 0.6326904296875,
    "mean_abs_diff": 0.09179522722959518,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "ec3d3f86dc5b7040a260f240a768de9841a794e8c39e1902f0cd9c6c4172e4fb",
      "l2_distance": 88.50921265701083,
      "reference_digest": "2e0b1065e28397742c3ab0b4d125830cdf8671c25e37983c86de3e19de4632f8"
    },
    "1600": {
      "available": true,
      "candidate_digest": "e2079e3d74ebebb6adb8e6e0590f0e8916167b4b1a3b33b19a9ca24085529a9d",
      "l2_distance": 86.27253375641853,
      "reference_digest": "2ec6053d5fe0eb5fcdfb77a61a34bd4c9de27078d5f6b8cf1b443cc94223d441"
    },
    "200": {
      "available": true,
      "candidate_digest": "9fb1d96d12d244eb1f7dbacc32a7126b6d3d09517e2f941c2da7863a08bbe51b",
      "l2_distance": 336.3487144801594,
      "reference_digest": "c879d42940fdb503db5e378da8dbbcb8f2da36bd172be792d036ce946a939a41"
    },
    "400": {
      "available": true,
      "candidate_digest": "1cce17d5ef2fc8a011ee69cd08ad841a5e8f80b27688547c49f2cd0b863209fc",
      "l2_distance": 162.79456825357872,
      "reference_digest": "b479cc44055b5c73dbb91aad92c9f608ef151e6fafec00708ac424e1a3b316d3"
    },
    "800": {
      "available": true,
      "candidate_digest": "d970b2dbe56b29a489755fbecfd08a0248599b13f650a0c59708b5bdfb84704c",
      "l2_distance": 101.60241646613109,
      "reference_digest": "c4ead4876b21d4a20b5410d43e759544eb964fff37c2d562319efdbf4e5102f7"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_reference seed=4242 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking seed=4242 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0218 04:43:34.792000 908645 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 908656 closing signal SIGTERM
W0218 04:43:34.793000 908645 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 908657 closing signal SIGTERM
W0218 04:43:34.793000 908645 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 908658 closing signal SIGTERM
E0218 04:43:34.972000 908645 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 908659) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:43:34
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 908656)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:43:34
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 908657)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:43:34
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 908658)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:43:34
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 908659)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0218 04:44:21.291000 908805 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 908816 closing signal SIGTERM
W0218 04:44:21.291000 908805 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 908818 closing signal SIGTERM
W0218 04:44:21.292000 908805 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 908819 closing signal SIGTERM
E0218 04:44:21.458000 908805 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 908817) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:44:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 908816)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:44:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 908818)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:44:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 908819)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:44:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 908817)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped seed=4242 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=0.586
[ECRL][fail-inject] step=800 close_done_sec=0.701
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 04:45:43.908000 909107 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 909119 closing signal SIGTERM
W0218 04:45:43.909000 909107 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 909120 closing signal SIGTERM
W0218 04:45:43.909000 909107 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 909122 closing signal SIGTERM
E0218 04:45:44.025000 909107 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 909121) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:45:44
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 909119)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:45:44
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 909120)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:45:44
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 909122)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:45:43
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 909121)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=0.619
[ECRL][fail-inject] step=1400 close_done_sec=0.586
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 04:46:30.054000 909328 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 909341 closing signal SIGTERM
W0218 04:46:30.055000 909328 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 909343 closing signal SIGTERM
E0218 04:46:30.170000 909328 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 909340) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:46:30
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 909342)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:46:30
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 909341)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:46:30
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 909343)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:46:30
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 909340)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.02038496232125908,
    "stall_time_sec_total": 11.737831628415734,
    "write_time_sec_total": 11.6816117571434
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 16.138045509168943,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 109.35167121887207,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771360955.0862315
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 99.14459586143494
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.02392595575656742,
    "stall_time_sec_total": 12.226395377889276,
    "write_time_sec_total": 12.168144290801138
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.502860366110612,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 128.76176285743713,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771361085.628194
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 118.49341225624084
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.255360595881939e-05,
    "enqueue_latency_sec_total": 3.541783626540564,
    "num_events": 35,
    "snapshot_time_sec_total": 0.02320008317474276,
    "stall_time_sec_total": 5.0849588417913765,
    "write_time_sec_total": 0.9917677129851654
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 13.791026174296215,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 127.70407700538635,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771361215.090059
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 116.01747250556946
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 140.3784339427948,
    "max_abs_diff": 0.5081787109375,
    "mean_abs_diff": 0.08779743336141109,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "85517e79965fd9e1bef8426023b38d8da6d3c5cfd647714be2ee25cd13c1cc67",
      "l2_distance": 118.00825653106278,
      "reference_digest": "f63da47e150780594ecdf4cb9b4ddedc1ea39b55e2b0869d5bfe632ef29fa925"
    },
    "1600": {
      "available": true,
      "candidate_digest": "1ce94e98a787bfbb225bb90c7989b93f3e04d2f2d61097b793346ab448c01c38",
      "l2_distance": 114.7477469789679,
      "reference_digest": "beec5da05fe9bce3a16154f70cf21a192b15c1300b0272de37a7f5ae789da4e8"
    },
    "200": {
      "available": true,
      "candidate_digest": "473dbdfecba901c72863cbe48143b6837623f67b5bebe9bedf15a0caa13887ec",
      "l2_distance": 238.38922461208915,
      "reference_digest": "2d161379e5dd9be880d0d12544584a4a33a518b04b798a33f7c834cafb72e85b"
    },
    "400": {
      "available": true,
      "candidate_digest": "09e781a8d9c6413050707b8414a898e773f3b47bfc86e9ae7a13edac5829240f",
      "l2_distance": 175.88762947430948,
      "reference_digest": "bc4fcaa25026571e2035639bc1c37ef8f9cc3063e8aacfaf1519b90c7bda2208"
    },
    "800": {
      "available": true,
      "candidate_digest": "e0f19fe7d19b09913984ab60f6d0eab4889f1df3e11bc7eb8f19f002ec3939d1",
      "l2_distance": 134.23913598505862,
      "reference_digest": "97d0be9bc97185b4e7f50361fb9209be30d7771fb33666408da5c5d143db1749"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 138.28982436656952,
    "max_abs_diff": 0.5177001953125,
    "mean_abs_diff": 0.08647508911788464,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "37fdd8b9002c7144c816f923bda287cea348bafe9f1534e9a2b650db3eb966a8",
      "l2_distance": 94.89884374643965,
      "reference_digest": "f63da47e150780594ecdf4cb9b4ddedc1ea39b55e2b0869d5bfe632ef29fa925"
    },
    "1600": {
      "available": true,
      "candidate_digest": "1c19a67a85f522be8e85af6b8687837e1ec667dcca80ad2759b9065cb4146cf7",
      "l2_distance": 92.27939359713862,
      "reference_digest": "beec5da05fe9bce3a16154f70cf21a192b15c1300b0272de37a7f5ae789da4e8"
    },
    "200": {
      "available": true,
      "candidate_digest": "09f53adc465e3e6c9bde7459577df273b997bfaee5de465e1431ecf8bb675f0b",
      "l2_distance": 207.88420535759914,
      "reference_digest": "2d161379e5dd9be880d0d12544584a4a33a518b04b798a33f7c834cafb72e85b"
    },
    "400": {
      "available": true,
      "candidate_digest": "5ad67d8b7dc88f0d41c28d15b26f7f17615d65751301468047f53312162885d1",
      "l2_distance": 145.27893238493849,
      "reference_digest": "bc4fcaa25026571e2035639bc1c37ef8f9cc3063e8aacfaf1519b90c7bda2208"
    },
    "800": {
      "available": true,
      "candidate_digest": "40f72b8928b13944a89e000aafc700527d84b0695dc67eb2f709155f5466087b",
      "l2_distance": 108.10400557155849,
      "reference_digest": "97d0be9bc97185b4e7f50361fb9209be30d7771fb33666408da5c5d143db1749"
    }
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.21976989466595462,
    "mean": 16.353030616659463,
    "n": 3,
    "std": 0.19421052221198662
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_reference",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference",
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_reference"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 16.51578418383933,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference",
      "snapshot_time_sec_total": 0.02648780809249729,
      "stall_time_sec_total": 11.252927842666395,
      "wall_clock_time_sec": 96.8770227432251,
      "write_time_sec_total": 11.192500202683732
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 16.405262156970117,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference",
      "snapshot_time_sec_total": 0.022590057458728552,
      "stall_time_sec_total": 11.069590437225997,
      "wall_clock_time_sec": 97.52968192100525,
      "write_time_sec_total": 11.013480203226209
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 16.138045509168943,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_reference",
      "snapshot_time_sec_total": 0.02038496232125908,
      "stall_time_sec_total": 11.737831628415734,
      "wall_clock_time_sec": 99.14459586143494,
      "write_time_sec_total": 11.6816117571434
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0034970008002176275,
    "mean": 0.023154275957494974,
    "n": 3,
    "std": 0.0030902974796356898
  },
  "stall_time_sec_total": {
    "ci95": 0.3907158866859735,
    "mean": 11.353449969436042,
    "n": 3,
    "std": 0.34527539135940327
  },
  "wall_clock_time_sec": {
    "ci95": 1.3209455576270348,
    "mean": 97.8504335085551,
    "n": 3,
    "std": 1.1673187856338911
  },
  "write_time_sec_total": {
    "ci95": 0.39136740215698035,
    "mean": 11.295864054351114,
    "n": 3,
    "std": 0.3458511351847609
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.15169727565236205,
    "mean": 13.652897525958613,
    "n": 3,
    "std": 0.13405479020391442
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_failure_blocking",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking",
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking",
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.760890713919324,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking",
      "snapshot_time_sec_total": 0.020597569877281785,
      "stall_time_sec_total": 10.873723419615999,
      "wall_clock_time_sec": 116.27154326438904,
      "write_time_sec_total": 10.8182362630032
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.694941497845901,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking",
      "snapshot_time_sec_total": 0.02321662788745016,
      "stall_time_sec_total": 11.352042638813145,
      "wall_clock_time_sec": 116.83145928382874,
      "write_time_sec_total": 11.29285556776449
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.502860366110612,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking",
      "snapshot_time_sec_total": 0.02392595575656742,
      "stall_time_sec_total": 12.226395377889276,
      "wall_clock_time_sec": 118.49341225624084,
      "write_time_sec_total": 12.168144290801138
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.001983851989070325,
    "mean": 0.022580051173766453,
    "n": 3,
    "std": 0.0017531287957991732
  },
  "stall_time_sec_total": {
    "ci95": 0.7762033638549268,
    "mean": 11.48405381210614,
    "n": 3,
    "std": 0.6859304404094924
  },
  "wall_clock_time_sec": {
    "ci95": 1.307670409420681,
    "mean": 117.19880493481953,
    "n": 3,
    "std": 1.1555875452403137
  },
  "write_time_sec_total": {
    "ci95": 0.7749157881389531,
    "mean": 11.426412040522942,
    "n": 3,
    "std": 0.6847926105326259
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.11737204600205645,
    "mean": 13.893357438271567,
    "n": 3,
    "std": 0.1037216056448333
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_failure_overlapped",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.890630531003355,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped",
      "snapshot_time_sec_total": 0.022668897872790694,
      "stall_time_sec_total": 5.007599964970723,
      "wall_clock_time_sec": 115.185555934906,
      "write_time_sec_total": 0.8999858919996768
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.998415609515131,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped",
      "snapshot_time_sec_total": 0.023272038088180125,
      "stall_time_sec_total": 4.921978801256046,
      "wall_clock_time_sec": 114.29864954948425,
      "write_time_sec_total": 0.8787611759034917
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 13.791026174296215,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped",
      "snapshot_time_sec_total": 0.02320008317474276,
      "stall_time_sec_total": 5.0849588417913765,
      "wall_clock_time_sec": 116.01747250556946,
      "write_time_sec_total": 0.9917677129851654
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0003727761798599453,
    "mean": 0.023047006378571194,
    "n": 3,
    "std": 0.0003294220833514588
  },
  "stall_time_sec_total": {
    "ci95": 0.09225412888860986,
    "mean": 5.004845869339381,
    "n": 3,
    "std": 0.081524917573
  },
  "wall_clock_time_sec": {
    "ci95": 0.9726815247601621,
    "mean": 115.16722599665324,
    "n": 3,
    "std": 0.8595580716674315
  },
  "write_time_sec_total": {
    "ci95": 0.06796687405728197,
    "mean": 0.923504926962778,
    "n": 3,
    "std": 0.06006228525451397
  }
}
{
  "markdown": "results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_publishable.md",
  "json": "results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_publishable.json"
}
[INFO] Cleaning checkpoints for completed runs...
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s1337_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s2027_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_s4242_failure_overlapped
[DONE] Publishable markdown: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_publishable.md
[DONE] Publishable json: results/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet18_flate_k50_m4_publishable.json
[MATRIX 7/8] run_prefix=exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4 dataset=cifar100 model=resnet50 fail=400,1200 k=50 inflight=4 port_base=43859
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar100 (size=50000)
[INFO] Model: resnet50
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0218 04:51:59.889000 910746 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 910757 closing signal SIGTERM
W0218 04:51:59.890000 910746 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 910758 closing signal SIGTERM
E0218 04:51:59.987000 910746 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 910756) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:51:59
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 910759)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:51:59
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 910757)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:51:59
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 910758)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:51:59
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 910756)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0218 04:53:35.511000 910897 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 910914 closing signal SIGTERM
W0218 04:53:35.512000 910897 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 910915 closing signal SIGTERM
W0218 04:53:35.513000 910897 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 910916 closing signal SIGTERM
E0218 04:53:35.678000 910897 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 910913) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:53:35
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 910914)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:53:35
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 910915)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:53:35
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 910916)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:53:35
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 910913)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=1.176
[ECRL][fail-inject] step=400 close_done_sec=0.618
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 04:55:22.960000 911263 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 911273 closing signal SIGTERM
W0218 04:55:22.961000 911263 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 911276 closing signal SIGTERM
E0218 04:55:23.076000 911263 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 911274) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:55:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 911275)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:55:23
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 911273)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:55:23
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 911276)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:55:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 911274)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=1.165
[ECRL][fail-inject] step=1200 close_done_sec=0.636
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 04:56:54.232000 911456 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 911466 closing signal SIGTERM
W0218 04:56:54.233000 911456 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 911467 closing signal SIGTERM
W0218 04:56:54.234000 911456 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 911469 closing signal SIGTERM
E0218 04:56:54.364000 911456 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 911468) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_04:56:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 911466)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_04:56:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 911467)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_04:56:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 911469)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_04:56:54
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 911468)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03779143386054784,
    "stall_time_sec_total": 23.693319144425914,
    "write_time_sec_total": 23.61798151722178
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 9.493252992977615,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 179.52117443084717,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771361467.427547
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 168.5407521724701
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.036428569816052914,
    "stall_time_sec_total": 23.38962956413161,
    "write_time_sec_total": 23.313070895848796
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.422987941420738,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 201.48745965957642,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771361670.6755798
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 189.9563446044922
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.401391975581646e-05,
    "enqueue_latency_sec_total": 6.858370721689425,
    "num_events": 35,
    "snapshot_time_sec_total": 0.041976273991167545,
    "stall_time_sec_total": 9.65306613710709,
    "write_time_sec_total": 1.9177420660853386
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.759900785702259,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 195.53410816192627,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771361868.010307
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 182.650470495224
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 59.428009033203125,
    "max_abs_diff": 0.295654296875,
    "mean_abs_diff": 0.03716739654541015,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "c72db84d359817caf1a25a16c3842dbf39833d0d3cc18b5a62346ace68007c52",
      "l2_distance": 907.4195250767725,
      "reference_digest": "4386020e15e7fbc2a94419a73a16a49093fcbe49dd2640007cd811fbc1e96468"
    },
    "1600": {
      "available": true,
      "candidate_digest": "2db141f643917066df13c5564123b6ab2a3daa38f98093719b177bd0ce34b1e0",
      "l2_distance": 1334.0490986829873,
      "reference_digest": "7fc1eef69db54389d4dc48cf13fa419d75936b5905149c827f62d44d4aaac2bc"
    },
    "200": {
      "available": true,
      "candidate_digest": "250e48d523d1f023972c7e79c4d34a23b56415db253dcaf17e4d399f74b13066",
      "l2_distance": 0.0,
      "reference_digest": "250e48d523d1f023972c7e79c4d34a23b56415db253dcaf17e4d399f74b13066"
    },
    "400": {
      "available": true,
      "candidate_digest": "855db80d573b715c6c1a43cc3bfd00c3341851c3db58f4f591a4fda6195f5366",
      "l2_distance": 0.0,
      "reference_digest": "855db80d573b715c6c1a43cc3bfd00c3341851c3db58f4f591a4fda6195f5366"
    },
    "800": {
      "available": true,
      "candidate_digest": "4e2ee79430ddbb96868e8a972a980202f0da11404c6791be0bed5fb20acf2c68",
      "l2_distance": 1132.7296186342508,
      "reference_digest": "c28ea8103f416eb008ea559b333b60b0439efb3392f0230dd98aea3180e6ab2b"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 59.428009033203125,
    "max_abs_diff": 0.295654296875,
    "mean_abs_diff": 0.03716739654541015,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "c72db84d359817caf1a25a16c3842dbf39833d0d3cc18b5a62346ace68007c52",
      "l2_distance": 907.4195250767725,
      "reference_digest": "4386020e15e7fbc2a94419a73a16a49093fcbe49dd2640007cd811fbc1e96468"
    },
    "1600": {
      "available": true,
      "candidate_digest": "2db141f643917066df13c5564123b6ab2a3daa38f98093719b177bd0ce34b1e0",
      "l2_distance": 1334.0490986829873,
      "reference_digest": "7fc1eef69db54389d4dc48cf13fa419d75936b5905149c827f62d44d4aaac2bc"
    },
    "200": {
      "available": true,
      "candidate_digest": "250e48d523d1f023972c7e79c4d34a23b56415db253dcaf17e4d399f74b13066",
      "l2_distance": 0.0,
      "reference_digest": "250e48d523d1f023972c7e79c4d34a23b56415db253dcaf17e4d399f74b13066"
    },
    "400": {
      "available": true,
      "candidate_digest": "855db80d573b715c6c1a43cc3bfd00c3341851c3db58f4f591a4fda6195f5366",
      "l2_distance": 0.0,
      "reference_digest": "855db80d573b715c6c1a43cc3bfd00c3341851c3db58f4f591a4fda6195f5366"
    },
    "800": {
      "available": true,
      "candidate_digest": "4e2ee79430ddbb96868e8a972a980202f0da11404c6791be0bed5fb20acf2c68",
      "l2_distance": 1132.7296186342508,
      "reference_digest": "c28ea8103f416eb008ea559b333b60b0439efb3392f0230dd98aea3180e6ab2b"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0218 05:02:48.554000 912450 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 912460 closing signal SIGTERM
W0218 05:02:48.555000 912450 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 912463 closing signal SIGTERM
E0218 05:02:48.670000 912450 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 912461) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:02:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 912462)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:02:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 912460)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:02:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 912463)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:02:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 912461)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0218 05:04:25.260000 912911 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 912924 closing signal SIGTERM
W0218 05:04:25.261000 912911 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 912925 closing signal SIGTERM
E0218 05:04:25.333000 912911 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 912923) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:04:25
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 912926)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:04:25
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 912924)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:04:25
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 912925)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:04:25
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 912923)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=1.124
[ECRL][fail-inject] step=400 close_done_sec=0.717
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:06:13.186000 913548 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 913561 closing signal SIGTERM
W0218 05:06:13.187000 913548 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 913563 closing signal SIGTERM
W0218 05:06:13.187000 913548 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 913564 closing signal SIGTERM
E0218 05:06:13.353000 913548 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 913562) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:06:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 913561)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:06:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 913563)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:06:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 913564)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:06:13
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 913562)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=1.244
[ECRL][fail-inject] step=1200 close_done_sec=0.644
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:07:47.951000 913732 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 913742 closing signal SIGTERM
W0218 05:07:47.952000 913732 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 913743 closing signal SIGTERM
W0218 05:07:47.952000 913732 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 913744 closing signal SIGTERM
E0218 05:07:48.081000 913732 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 3 (pid: 913745) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:07:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 913742)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:07:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 913743)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:07:48
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 913744)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:07:47
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 913745)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03559177916031331,
    "stall_time_sec_total": 23.779598691500723,
    "write_time_sec_total": 23.705698858830146
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 9.33013722179513,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 182.65617966651917,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771362115.1894248
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 171.487295627594
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.040565958130173385,
    "stall_time_sec_total": 25.764275030698627,
    "write_time_sec_total": 25.68489343521651
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.268631093060687,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 204.82669806480408,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771362321.7947407
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 193.50240468978882
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.064357977360487e-05,
    "enqueue_latency_sec_total": 7.42221209674608,
    "num_events": 35,
    "snapshot_time_sec_total": 0.038821784080937505,
    "stall_time_sec_total": 10.17192073550541,
    "write_time_sec_total": 2.017551166936755
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.584076785039034,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 199.75562405586243,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771362523.4783883
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 186.39162254333496
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 71.8996696472168,
    "max_abs_diff": 0.309326171875,
    "mean_abs_diff": 0.04497502088546753,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "2f6bf51794fbbb158c7d653e63594ed77937d7d22f7e473212c20874ef65bf3b",
      "l2_distance": 12477.882700509695,
      "reference_digest": "ee4ac3a0a4d468fefe0dc4b897ff553d4f42b6b52f0aa5451d24eb14267951f8"
    },
    "1600": {
      "available": true,
      "candidate_digest": "80cb2803a9df35e1008701a1b4183f717b623a8fec66d0feeb7da6a7132fa04f",
      "l2_distance": 14606.95435286665,
      "reference_digest": "1007a21d4e6ca9b3eb0606f5587af4209717c4586da5ffd83327dcaaeb0d36e2"
    },
    "200": {
      "available": true,
      "candidate_digest": "d267724b695096002705af84d02feb1b4403201088e36a6e816b6230bd1d71ea",
      "l2_distance": 0.0,
      "reference_digest": "d267724b695096002705af84d02feb1b4403201088e36a6e816b6230bd1d71ea"
    },
    "400": {
      "available": true,
      "candidate_digest": "c8f8b4da12eccb481a752f6bc7221dcef679941477739b8b36f6fe8be81fc741",
      "l2_distance": 0.0,
      "reference_digest": "c8f8b4da12eccb481a752f6bc7221dcef679941477739b8b36f6fe8be81fc741"
    },
    "800": {
      "available": true,
      "candidate_digest": "a454db7bc9d9aed7a05f1cb03d417c2aec2c22cd4c1ac5a75c8402763467f6d6",
      "l2_distance": 4669.905682518024,
      "reference_digest": "ee908705fd1572b7f44c3cb458b125747f310c367a8cff8a281e1d26177a8f0e"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 71.8996696472168,
    "max_abs_diff": 0.309326171875,
    "mean_abs_diff": 0.04497502088546753,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "2f6bf51794fbbb158c7d653e63594ed77937d7d22f7e473212c20874ef65bf3b",
      "l2_distance": 12477.882700509695,
      "reference_digest": "ee4ac3a0a4d468fefe0dc4b897ff553d4f42b6b52f0aa5451d24eb14267951f8"
    },
    "1600": {
      "available": true,
      "candidate_digest": "80cb2803a9df35e1008701a1b4183f717b623a8fec66d0feeb7da6a7132fa04f",
      "l2_distance": 14606.95435286665,
      "reference_digest": "1007a21d4e6ca9b3eb0606f5587af4209717c4586da5ffd83327dcaaeb0d36e2"
    },
    "200": {
      "available": true,
      "candidate_digest": "d267724b695096002705af84d02feb1b4403201088e36a6e816b6230bd1d71ea",
      "l2_distance": 0.0,
      "reference_digest": "d267724b695096002705af84d02feb1b4403201088e36a6e816b6230bd1d71ea"
    },
    "400": {
      "available": true,
      "candidate_digest": "c8f8b4da12eccb481a752f6bc7221dcef679941477739b8b36f6fe8be81fc741",
      "l2_distance": 0.0,
      "reference_digest": "c8f8b4da12eccb481a752f6bc7221dcef679941477739b8b36f6fe8be81fc741"
    },
    "800": {
      "available": true,
      "candidate_digest": "a454db7bc9d9aed7a05f1cb03d417c2aec2c22cd4c1ac5a75c8402763467f6d6",
      "l2_distance": 4669.905682518024,
      "reference_digest": "ee908705fd1572b7f44c3cb458b125747f310c367a8cff8a281e1d26177a8f0e"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_reference seed=4242 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking seed=4242 nproc=4 target=1600 strategy=blocking fail=400,1200
[ECRL][fail-inject] step=400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
W0218 05:13:46.527000 915654 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 915665 closing signal SIGTERM
W0218 05:13:46.528000 915654 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 915666 closing signal SIGTERM
W0218 05:13:46.528000 915654 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 915667 closing signal SIGTERM
E0218 05:13:46.657000 915654 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 915664) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:13:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 915665)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:13:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 915666)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:13:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 915667)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:13:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 915664)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
W0218 05:15:22.759000 915807 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 915818 closing signal SIGTERM
W0218 05:15:22.760000 915807 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 915819 closing signal SIGTERM
W0218 05:15:22.761000 915807 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 915820 closing signal SIGTERM
E0218 05:15:22.926000 915807 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 915817) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:15:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 915818)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:15:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 915819)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:15:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 915820)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:15:22
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 915817)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped seed=4242 nproc=4 target=1600 strategy=overlapped fail=400,1200
[ECRL][fail-inject] step=400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=400 flush_done_sec=1.059
[ECRL][fail-inject] step=400 close_done_sec=0.698
[ECRL][fail-inject] step=400 entering synchronized exit barrier
[ECRL][fail-inject] step=400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:17:09.351000 916292 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 916304 closing signal SIGTERM
W0218 05:17:09.352000 916292 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 916305 closing signal SIGTERM
E0218 05:17:09.467000 916292 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 916302) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:17:09
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 916303)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:17:09
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 916304)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:17:09
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 916305)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:17:09
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 916302)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped/step_00000400.pt global_step=400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1200 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1200 flush_done_sec=1.190
[ECRL][fail-inject] step=1200 close_done_sec=0.641
[ECRL][fail-inject] step=1200 entering synchronized exit barrier
[ECRL][fail-inject] step=1200 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:18:40.045000 916454 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 916464 closing signal SIGTERM
W0218 05:18:40.046000 916454 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 916466 closing signal SIGTERM
E0218 05:18:40.142000 916454 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 916465) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:18:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 916467)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:18:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 916464)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:18:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 916466)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:18:40
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 916465)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped/step_00001200.pt global_step=1200 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03853104647714645,
    "stall_time_sec_total": 24.631963331834413,
    "write_time_sec_total": 24.55586072523147
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 9.370670267924663,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 182.2991704940796,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771362771.468877
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 170.7455234527588
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.04061107395682484,
    "stall_time_sec_total": 26.09622903680429,
    "write_time_sec_total": 26.011475282139145
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.365420726829374,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 203.2078185081482,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771362977.2921677
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 191.26354217529297
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.3531727492809296e-05,
    "enqueue_latency_sec_total": 7.150204510893673,
    "num_events": 35,
    "snapshot_time_sec_total": 0.045352995046414435,
    "stall_time_sec_total": 9.622695904341526,
    "write_time_sec_total": 1.8977469940437004
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.745057004480772,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 195.68108201026917,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771363174.9056273
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 182.96049976348877
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 80.19902801513672,
    "max_abs_diff": 0.332855224609375,
    "mean_abs_diff": 0.05014846324920654,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "f6b2dbdac85b7f8db7ec9550f3227dd303d1350ea23511df20d51481780719e4",
      "l2_distance": 818.5125818529788,
      "reference_digest": "a9d56782e1462c71a91decf2aa4b522e20c7ce2137fb68d9d706390ae134d1d3"
    },
    "1600": {
      "available": true,
      "candidate_digest": "07b90be6dc0c8ef252d5e94ccc1bf0bf0ca7c4e18c6b216ed44a6455d0fe334c",
      "l2_distance": 1360.6644141551756,
      "reference_digest": "62db1797fa6f37afa09d842e8cf101ddc272cfcdfc526a28b44be66afb0f5d78"
    },
    "200": {
      "available": true,
      "candidate_digest": "ef3a6a70daece9de6fdc45c5dc11f8a2741d46946d2232ce60dc808567c00407",
      "l2_distance": 0.0,
      "reference_digest": "ef3a6a70daece9de6fdc45c5dc11f8a2741d46946d2232ce60dc808567c00407"
    },
    "400": {
      "available": true,
      "candidate_digest": "de460a0aca8f750f22a6071f0d1b2d029cd99b8aa371282ffd93b59958c5e380",
      "l2_distance": 0.0,
      "reference_digest": "de460a0aca8f750f22a6071f0d1b2d029cd99b8aa371282ffd93b59958c5e380"
    },
    "800": {
      "available": true,
      "candidate_digest": "87872f604cc555b6ec1f7f71776e863f476b08c8741125f7403a8f69e43af441",
      "l2_distance": 2374.257910307002,
      "reference_digest": "1ef5fb8fdbf096d27a6c0d1b1b91c20455f1c8e68b8f95776eb09d728a5bf477"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 80.19902801513672,
    "max_abs_diff": 0.332855224609375,
    "mean_abs_diff": 0.05014846324920654,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "f6b2dbdac85b7f8db7ec9550f3227dd303d1350ea23511df20d51481780719e4",
      "l2_distance": 818.5125818529788,
      "reference_digest": "a9d56782e1462c71a91decf2aa4b522e20c7ce2137fb68d9d706390ae134d1d3"
    },
    "1600": {
      "available": true,
      "candidate_digest": "07b90be6dc0c8ef252d5e94ccc1bf0bf0ca7c4e18c6b216ed44a6455d0fe334c",
      "l2_distance": 1360.6644141551756,
      "reference_digest": "62db1797fa6f37afa09d842e8cf101ddc272cfcdfc526a28b44be66afb0f5d78"
    },
    "200": {
      "available": true,
      "candidate_digest": "ef3a6a70daece9de6fdc45c5dc11f8a2741d46946d2232ce60dc808567c00407",
      "l2_distance": 0.0,
      "reference_digest": "ef3a6a70daece9de6fdc45c5dc11f8a2741d46946d2232ce60dc808567c00407"
    },
    "400": {
      "available": true,
      "candidate_digest": "de460a0aca8f750f22a6071f0d1b2d029cd99b8aa371282ffd93b59958c5e380",
      "l2_distance": 0.0,
      "reference_digest": "de460a0aca8f750f22a6071f0d1b2d029cd99b8aa371282ffd93b59958c5e380"
    },
    "800": {
      "available": true,
      "candidate_digest": "87872f604cc555b6ec1f7f71776e863f476b08c8741125f7403a8f69e43af441",
      "l2_distance": 2374.257910307002,
      "reference_digest": "1ef5fb8fdbf096d27a6c0d1b1b91c20455f1c8e68b8f95776eb09d728a5bf477"
    }
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.09610465281430834,
    "mean": 9.398020160899135,
    "n": 3,
    "std": 0.08492762322354558
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_reference",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_reference",
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_reference",
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_reference"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 9.493252992977615,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_reference",
      "snapshot_time_sec_total": 0.03779143386054784,
      "stall_time_sec_total": 23.693319144425914,
      "wall_clock_time_sec": 168.5407521724701,
      "write_time_sec_total": 23.61798151722178
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 9.33013722179513,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_reference",
      "snapshot_time_sec_total": 0.03559177916031331,
      "stall_time_sec_total": 23.779598691500723,
      "wall_clock_time_sec": 171.487295627594,
      "write_time_sec_total": 23.705698858830146
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 9.370670267924663,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_reference",
      "snapshot_time_sec_total": 0.03853104647714645,
      "stall_time_sec_total": 24.631963331834413,
      "wall_clock_time_sec": 170.7455234527588,
      "write_time_sec_total": 24.55586072523147
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0017300878528357581,
    "mean": 0.037304753166002534,
    "n": 3,
    "std": 0.0015288775829945306
  },
  "stall_time_sec_total": {
    "ci95": 0.5870959902350095,
    "mean": 24.034960389253683,
    "n": 3,
    "std": 0.5188163693913254
  },
  "wall_clock_time_sec": {
    "ci95": 1.7343114937011885,
    "mean": 170.2578570842743,
    "n": 3,
    "std": 1.532610011857719
  },
  "write_time_sec_total": {
    "ci95": 0.5861982025632858,
    "mean": 23.959847033761132,
    "n": 3,
    "std": 0.5180229949720222
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.08827045205463793,
    "mean": 8.3523465871036,
    "n": 3,
    "std": 0.07800454477842117
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_failure_blocking",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking",
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking",
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.422987941420738,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking",
      "snapshot_time_sec_total": 0.036428569816052914,
      "stall_time_sec_total": 23.38962956413161,
      "wall_clock_time_sec": 189.9563446044922,
      "write_time_sec_total": 23.313070895848796
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.268631093060687,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking",
      "snapshot_time_sec_total": 0.040565958130173385,
      "stall_time_sec_total": 25.764275030698627,
      "wall_clock_time_sec": 193.50240468978882,
      "write_time_sec_total": 25.68489343521651
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.365420726829374,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking",
      "snapshot_time_sec_total": 0.04061107395682484,
      "stall_time_sec_total": 26.09622903680429,
      "wall_clock_time_sec": 191.26354217529297,
      "write_time_sec_total": 26.011475282139145
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0027179514097151226,
    "mean": 0.039201867301017046,
    "n": 3,
    "std": 0.002401852007209207
  },
  "stall_time_sec_total": {
    "ci95": 1.6704658415644664,
    "mean": 25.083377877211507,
    "n": 3,
    "std": 1.4761896479071215
  },
  "wall_clock_time_sec": {
    "ci95": 2.02932384922162,
    "mean": 191.57409715652466,
    "n": 3,
    "std": 1.7933122509505557
  },
  "write_time_sec_total": {
    "ci95": 1.6665497400892897,
    "mean": 25.003146537734818,
    "n": 3,
    "std": 1.4727289914159982
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.11034280502834633,
    "mean": 8.696344858407356,
    "n": 3,
    "std": 0.09750986967283798
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_failure_overlapped",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.759900785702259,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped",
      "snapshot_time_sec_total": 0.041976273991167545,
      "stall_time_sec_total": 9.65306613710709,
      "wall_clock_time_sec": 182.650470495224,
      "write_time_sec_total": 1.9177420660853386
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.584076785039034,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped",
      "snapshot_time_sec_total": 0.038821784080937505,
      "stall_time_sec_total": 10.17192073550541,
      "wall_clock_time_sec": 186.39162254333496,
      "write_time_sec_total": 2.017551166936755
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.745057004480772,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped",
      "snapshot_time_sec_total": 0.045352995046414435,
      "stall_time_sec_total": 9.622695904341526,
      "wall_clock_time_sec": 182.96049976348877,
      "write_time_sec_total": 1.8977469940437004
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0036960934790796597,
    "mean": 0.042050351039506495,
    "n": 3,
    "std": 0.003266235558821421
  },
  "stall_time_sec_total": {
    "ci95": 0.34932883527929004,
    "mean": 9.815894258984676,
    "n": 3,
    "std": 0.3087016792105049
  },
  "wall_clock_time_sec": {
    "ci95": 2.349500594111634,
    "mean": 184.00086426734924,
    "n": 3,
    "std": 2.0762522456197003
  },
  "write_time_sec_total": {
    "ci95": 0.07262689625231403,
    "mean": 1.9443467423552647,
    "n": 3,
    "std": 0.06418034403318448
  }
}
{
  "markdown": "results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_publishable.md",
  "json": "results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_publishable.json"
}
[INFO] Cleaning checkpoints for completed runs...
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s1337_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s2027_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_s4242_failure_overlapped
[DONE] Publishable markdown: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_publishable.md
[DONE] Publishable json: results/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet50_fbase_k50_m4_publishable.json
[MATRIX 8/8] run_prefix=exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4 dataset=cifar100 model=resnet50 fail=800,1400 k=50 inflight=4 port_base=43909
[INFO] Run prefix: exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4
[INFO] Results dir: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4
[INFO] Runtime patch check: ok
[INFO] Profile: small
[INFO] Dataset: cifar100 (size=50000)
[INFO] Model: resnet50
[INFO] Seeds: 1337,2027,4242
[INFO] NPROC: 4
[INFO] Resume suite: 1
[INFO] Supervisor start-resume-latest: 1
[INFO] Delete checkpoints on complete: 1
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_reference seed=1337 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking seed=1337 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0218 05:25:31.128000 917643 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 917654 closing signal SIGTERM
W0218 05:25:31.129000 917643 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 917655 closing signal SIGTERM
E0218 05:25:31.244000 917643 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 917653) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:25:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 917656)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:25:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 917654)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:25:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 917655)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:25:31
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 917653)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0218 05:26:45.853000 917864 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 917878 closing signal SIGTERM
W0218 05:26:45.854000 917864 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 917881 closing signal SIGTERM
E0218 05:26:45.951000 917864 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 917879) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:26:45
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 917880)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:26:45
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 917878)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:26:45
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 917881)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:26:45
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 917879)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped seed=1337 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=1.060
[ECRL][fail-inject] step=800 close_done_sec=0.629
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:28:50.737000 918383 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 918393 closing signal SIGTERM
W0218 05:28:50.738000 918383 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 918394 closing signal SIGTERM
E0218 05:28:50.853000 918383 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 918395) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:28:50
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 918396)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:28:50
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 918393)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:28:50
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 918394)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:28:50
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 918395)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=1.111
[ECRL][fail-inject] step=1400 close_done_sec=0.665
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:30:03.319000 918631 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 918648 closing signal SIGTERM
W0218 05:30:03.319000 918631 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 918649 closing signal SIGTERM
W0218 05:30:03.320000 918631 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 918650 closing signal SIGTERM
E0218 05:30:03.467000 918631 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 918647) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:30:03
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 918648)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:30:03
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 918649)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:30:03
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 918650)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:30:03
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 918647)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03604869812261313,
    "stall_time_sec_total": 22.273760708398186,
    "write_time_sec_total": 22.20107523421757
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 9.362424152251101,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 182.23313546180725,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771363435.479242
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 170.8959105014801
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03950369043741375,
    "stall_time_sec_total": 25.712434791144915,
    "write_time_sec_total": 25.632763053523377
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.377341386870535,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 202.4732894897461,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771363639.7594068
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 190.9913809299469
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.301926724612713e-05,
    "enqueue_latency_sec_total": 6.9000675233546644,
    "num_events": 35,
    "snapshot_time_sec_total": 0.039920840063132346,
    "stall_time_sec_total": 9.67277186177671,
    "write_time_sec_total": 1.9190560970455408
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.739583353112005,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 195.4606487751007,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771363836.9800365
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 183.07508897781372
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 41.860382080078125,
    "max_abs_diff": 0.291259765625,
    "mean_abs_diff": 0.026190757751464844,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "99ddb8ca46c65fbec423ab1768f2174131d8de151ad47419cdc93f160cbce558",
      "l2_distance": 723.6824356445865,
      "reference_digest": "4386020e15e7fbc2a94419a73a16a49093fcbe49dd2640007cd811fbc1e96468"
    },
    "1600": {
      "available": true,
      "candidate_digest": "8e2908307085d26f77e63f5398964943ff5d025680d3798fc09d4b4dc8f1a2c5",
      "l2_distance": 1360.538301415251,
      "reference_digest": "7fc1eef69db54389d4dc48cf13fa419d75936b5905149c827f62d44d4aaac2bc"
    },
    "200": {
      "available": true,
      "candidate_digest": "250e48d523d1f023972c7e79c4d34a23b56415db253dcaf17e4d399f74b13066",
      "l2_distance": 0.0,
      "reference_digest": "250e48d523d1f023972c7e79c4d34a23b56415db253dcaf17e4d399f74b13066"
    },
    "400": {
      "available": true,
      "candidate_digest": "855db80d573b715c6c1a43cc3bfd00c3341851c3db58f4f591a4fda6195f5366",
      "l2_distance": 0.0,
      "reference_digest": "855db80d573b715c6c1a43cc3bfd00c3341851c3db58f4f591a4fda6195f5366"
    },
    "800": {
      "available": true,
      "candidate_digest": "c28ea8103f416eb008ea559b333b60b0439efb3392f0230dd98aea3180e6ab2b",
      "l2_distance": 0.0,
      "reference_digest": "c28ea8103f416eb008ea559b333b60b0439efb3392f0230dd98aea3180e6ab2b"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 41.860382080078125,
    "max_abs_diff": 0.291259765625,
    "mean_abs_diff": 0.026190757751464844,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "99ddb8ca46c65fbec423ab1768f2174131d8de151ad47419cdc93f160cbce558",
      "l2_distance": 723.6824356445865,
      "reference_digest": "4386020e15e7fbc2a94419a73a16a49093fcbe49dd2640007cd811fbc1e96468"
    },
    "1600": {
      "available": true,
      "candidate_digest": "8e2908307085d26f77e63f5398964943ff5d025680d3798fc09d4b4dc8f1a2c5",
      "l2_distance": 1360.538301415251,
      "reference_digest": "7fc1eef69db54389d4dc48cf13fa419d75936b5905149c827f62d44d4aaac2bc"
    },
    "200": {
      "available": true,
      "candidate_digest": "250e48d523d1f023972c7e79c4d34a23b56415db253dcaf17e4d399f74b13066",
      "l2_distance": 0.0,
      "reference_digest": "250e48d523d1f023972c7e79c4d34a23b56415db253dcaf17e4d399f74b13066"
    },
    "400": {
      "available": true,
      "candidate_digest": "855db80d573b715c6c1a43cc3bfd00c3341851c3db58f4f591a4fda6195f5366",
      "l2_distance": 0.0,
      "reference_digest": "855db80d573b715c6c1a43cc3bfd00c3341851c3db58f4f591a4fda6195f5366"
    },
    "800": {
      "available": true,
      "candidate_digest": "c28ea8103f416eb008ea559b333b60b0439efb3392f0230dd98aea3180e6ab2b",
      "l2_distance": 0.0,
      "reference_digest": "c28ea8103f416eb008ea559b333b60b0439efb3392f0230dd98aea3180e6ab2b"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_reference seed=2027 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking seed=2027 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0218 05:36:15.244000 919973 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 919989 closing signal SIGTERM
W0218 05:36:15.245000 919973 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 919990 closing signal SIGTERM
W0218 05:36:15.246000 919973 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 919991 closing signal SIGTERM
E0218 05:36:15.374000 919973 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 919988) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:36:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 919989)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:36:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 919990)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:36:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 919991)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:36:15
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 919988)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0218 05:37:28.522000 920387 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 920397 closing signal SIGTERM
W0218 05:37:28.523000 920387 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 920399 closing signal SIGTERM
E0218 05:37:28.638000 920387 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 1 (pid: 920398) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:37:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 920400)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:37:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 920397)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:37:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 920399)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:37:28
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 920398)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped seed=2027 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=1.207
[ECRL][fail-inject] step=800 close_done_sec=0.743
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:39:33.794000 920957 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 920971 closing signal SIGTERM
W0218 05:39:33.795000 920957 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 920972 closing signal SIGTERM
E0218 05:39:33.892000 920957 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 920969) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:39:33
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 920970)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:39:33
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 920971)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:39:33
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 920972)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:39:33
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 920969)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=1.231
[ECRL][fail-inject] step=1400 close_done_sec=0.676
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:40:46.844000 921126 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 921137 closing signal SIGTERM
W0218 05:40:46.845000 921126 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 921138 closing signal SIGTERM
E0218 05:40:46.960000 921126 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 921136) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:40:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 921139)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:40:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 921137)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:40:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 921138)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:40:46
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 921136)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.039638837333768606,
    "stall_time_sec_total": 23.257988682831638,
    "write_time_sec_total": 23.182387247565202
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 9.531631652766306,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 179.15706396102905,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771364080.884676
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 167.86213088035583
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.038674052339047194,
    "stall_time_sec_total": 23.72320666303858,
    "write_time_sec_total": 23.645930183120072
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.485380615724788,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 200.26991534233093,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771364282.9165387
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 188.55960297584534
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.1984102204442024e-05,
    "enqueue_latency_sec_total": 7.084767219959758,
    "num_events": 35,
    "snapshot_time_sec_total": 0.04814912716392428,
    "stall_time_sec_total": 9.943844342138618,
    "write_time_sec_total": 1.96620356105268
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.731233237522723,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 195.93080282211304,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771364480.7462075
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 183.25017285346985
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 59.97165298461914,
    "max_abs_diff": 0.43701171875,
    "mean_abs_diff": 0.037498838901519775,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "426245c529647162a41432640128dd351d9b6e61da835246170ae8625870e9b5",
      "l2_distance": 32005.029412041487,
      "reference_digest": "ee4ac3a0a4d468fefe0dc4b897ff553d4f42b6b52f0aa5451d24eb14267951f8"
    },
    "1600": {
      "available": true,
      "candidate_digest": "121a7bb09c06f8eac11b978a7a72b7febd5a11ba08e7dbe2d8dafa9fe506c936",
      "l2_distance": 29294.609624474633,
      "reference_digest": "1007a21d4e6ca9b3eb0606f5587af4209717c4586da5ffd83327dcaaeb0d36e2"
    },
    "200": {
      "available": true,
      "candidate_digest": "d267724b695096002705af84d02feb1b4403201088e36a6e816b6230bd1d71ea",
      "l2_distance": 0.0,
      "reference_digest": "d267724b695096002705af84d02feb1b4403201088e36a6e816b6230bd1d71ea"
    },
    "400": {
      "available": true,
      "candidate_digest": "c8f8b4da12eccb481a752f6bc7221dcef679941477739b8b36f6fe8be81fc741",
      "l2_distance": 0.0,
      "reference_digest": "c8f8b4da12eccb481a752f6bc7221dcef679941477739b8b36f6fe8be81fc741"
    },
    "800": {
      "available": true,
      "candidate_digest": "ee908705fd1572b7f44c3cb458b125747f310c367a8cff8a281e1d26177a8f0e",
      "l2_distance": 0.0,
      "reference_digest": "ee908705fd1572b7f44c3cb458b125747f310c367a8cff8a281e1d26177a8f0e"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 59.97165298461914,
    "max_abs_diff": 0.43701171875,
    "mean_abs_diff": 0.037498838901519775,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "426245c529647162a41432640128dd351d9b6e61da835246170ae8625870e9b5",
      "l2_distance": 32005.029412041487,
      "reference_digest": "ee4ac3a0a4d468fefe0dc4b897ff553d4f42b6b52f0aa5451d24eb14267951f8"
    },
    "1600": {
      "available": true,
      "candidate_digest": "121a7bb09c06f8eac11b978a7a72b7febd5a11ba08e7dbe2d8dafa9fe506c936",
      "l2_distance": 29294.609624474633,
      "reference_digest": "1007a21d4e6ca9b3eb0606f5587af4209717c4586da5ffd83327dcaaeb0d36e2"
    },
    "200": {
      "available": true,
      "candidate_digest": "d267724b695096002705af84d02feb1b4403201088e36a6e816b6230bd1d71ea",
      "l2_distance": 0.0,
      "reference_digest": "d267724b695096002705af84d02feb1b4403201088e36a6e816b6230bd1d71ea"
    },
    "400": {
      "available": true,
      "candidate_digest": "c8f8b4da12eccb481a752f6bc7221dcef679941477739b8b36f6fe8be81fc741",
      "l2_distance": 0.0,
      "reference_digest": "c8f8b4da12eccb481a752f6bc7221dcef679941477739b8b36f6fe8be81fc741"
    },
    "800": {
      "available": true,
      "candidate_digest": "ee908705fd1572b7f44c3cb458b125747f310c367a8cff8a281e1d26177a8f0e",
      "l2_distance": 0.0,
      "reference_digest": "ee908705fd1572b7f44c3cb458b125747f310c367a8cff8a281e1d26177a8f0e"
    }
  }
}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_reference seed=4242 nproc=4 target=1600 strategy=blocking fail=none
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking seed=4242 nproc=4 target=1600 strategy=blocking fail=800,1400
[ECRL][fail-inject] step=800 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
W0218 05:47:02.294000 922021 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922034 closing signal SIGTERM
W0218 05:47:02.295000 922021 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922035 closing signal SIGTERM
E0218 05:47:02.392000 922021 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 922036) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:47:02
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 922037)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:47:02
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 922034)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:47:02
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 922035)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:47:02
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 922036)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=blocking starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
W0218 05:48:16.039000 922204 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922216 closing signal SIGTERM
W0218 05:48:16.039000 922204 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922217 closing signal SIGTERM
W0218 05:48:16.040000 922204 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922219 closing signal SIGTERM
E0218 05:48:16.255000 922204 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 2 (pid: 922218) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:48:16
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 922216)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:48:16
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 922217)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:48:16
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 922219)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:48:16
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 922218)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[RUN] exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped seed=4242 nproc=4 target=1600 strategy=overlapped fail=800,1400
[ECRL][fail-inject] step=800 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=800 flush_done_sec=1.165
[ECRL][fail-inject] step=800 close_done_sec=0.631
[ECRL][fail-inject] step=800 entering synchronized exit barrier
[ECRL][fail-inject] step=800 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:50:21.243000 922491 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922505 closing signal SIGTERM
W0218 05:50:21.244000 922491 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922506 closing signal SIGTERM
E0218 05:50:21.324000 922491 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 922503) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:50:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 922504)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:50:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 922505)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:50:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 922506)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:50:21
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 922503)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped/step_00000800.pt global_step=800 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
[ECRL][fail-inject] step=1400 strategy=overlapped starting pre-exit flush/barrier
[ECRL][fail-inject] step=1400 flush_done_sec=1.145
[ECRL][fail-inject] step=1400 close_done_sec=0.667
[ECRL][fail-inject] step=1400 entering synchronized exit barrier
[ECRL][fail-inject] step=1400 all ranks exiting with 137 after synchronized flush
/tmp2/b11902156/miniconda3/envs/ecrl/lib/python3.11/multiprocessing/resource_tracker.py:254: UserWarning: resource_tracker: There appear to be 6 leaked semaphore objects to clean up at shutdown
  warnings.warn('resource_tracker: There appear to be %d '
W0218 05:51:32.033000 922795 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922807 closing signal SIGTERM
W0218 05:51:32.034000 922795 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:1010] Sending process 922808 closing signal SIGTERM
E0218 05:51:32.149000 922795 .venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/api.py:984] failed (exitcode: 137) local_rank: 0 (pid: 922805) of binary: /tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/bin/python
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 995, in <module>
    main()
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/elastic/multiprocessing/errors/__init__.py", line 362, in wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 991, in main
    run(args)
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/run.py", line 982, in run
    elastic_launch(
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 170, in __call__
    return launch_agent(self._config, self._entrypoint, list(args))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/tmp2/b11902156/projects/Elastic-Correct-Recovery-Lab/.venv/lib/python3.11/site-packages/torch/distributed/launcher/api.py", line 317, in launch_agent
    raise ChildFailedError(
torch.distributed.elastic.multiprocessing.errors.ChildFailedError: 
============================================================
ecrl.train.ddp_train FAILED
------------------------------------------------------------
Failures:
[1]:
  time      : 2026-02-18_05:51:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 1 (local_rank: 1)
  exitcode  : 137 (pid: 922806)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[2]:
  time      : 2026-02-18_05:51:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 2 (local_rank: 2)
  exitcode  : 137 (pid: 922807)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
[3]:
  time      : 2026-02-18_05:51:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 3 (local_rank: 3)
  exitcode  : 137 (pid: 922808)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
------------------------------------------------------------
Root Cause (first observed failure):
[0]:
  time      : 2026-02-18_05:51:32
  host      : meow1.csie.ntu.edu.tw
  rank      : 0 (local_rank: 0)
  exitcode  : 137 (pid: 922805)
  error_file: <N/A>
  traceback : To enable traceback see: https://pytorch.org/docs/stable/elastic/errors.html
============================================================
[ECRL][resume] path=results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped/step_00001400.pt global_step=1400 rng_cpu={'type': 'tensor', 'dtype': 'torch.uint8', 'device': 'cuda:0', 'shape': (5056,)}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_reference",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03399125533178449,
    "stall_time_sec_total": 24.56147606857121,
    "write_time_sec_total": 24.489430124871433
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 9.422427975751233,
  "replayed_steps": 0,
  "restarts": 0,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_reference",
  "supervisor": {
    "attempts": 1,
    "duration_sec": 181.17905592918396,
    "restarts": 0,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771364726.7825432
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 169.807612657547
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 0.0,
    "enqueue_latency_sec_total": 0.0,
    "num_events": 32,
    "snapshot_time_sec_total": 0.03865784080699086,
    "stall_time_sec_total": 23.771406751824543,
    "write_time_sec_total": 23.695296354824677
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.420565614838658,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 201.20143294334412,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771364929.7547996
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 190.01098895072937
}
{
  "epochs": {
    "0": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "1": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "2": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "3": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "4": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "5": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "6": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "7": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 195
    },
    "8": {
      "duplicates": 0,
      "extra": 0,
      "missing": 0,
      "steps": 40
    }
  },
  "failures": [],
  "global_batch": 256,
  "num_failures": 0,
  "passed": true,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped",
  "steps_per_epoch": 195
}
{
  "checkpoint": {
    "backpressure_wait_sec_total": 2.077349927276373e-05,
    "enqueue_latency_sec_total": 7.01375503372401,
    "num_events": 35,
    "snapshot_time_sec_total": 0.037130586337298155,
    "stall_time_sec_total": 9.666528208763339,
    "write_time_sec_total": 1.8745924440445378
  },
  "final_step": 1600,
  "goodput_steps_per_sec": 8.816812629077232,
  "replayed_steps": 0,
  "restarts": 2,
  "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped",
  "supervisor": {
    "attempts": 3,
    "duration_sec": 193.9023735523224,
    "restarts": 2,
    "restarts_without_checkpoint_streak": 0,
    "restarts_without_checkpoint_total": 0,
    "status": "completed",
    "target_steps": 1600,
    "time": 1771365125.5747843
  },
  "useful_steps": 1600,
  "wall_clock_time_sec": 181.47147583961487
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking",
  "loss_divergence": {
    "auc_abs_diff": 56.01361083984375,
    "max_abs_diff": 1.4541015625,
    "mean_abs_diff": 0.035013675689697266,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "06f299a92572fdd652abc83b94cfeb1dce5c37292ca4065608b808d999999ed1",
      "l2_distance": 824.8284061980333,
      "reference_digest": "a9d56782e1462c71a91decf2aa4b522e20c7ce2137fb68d9d706390ae134d1d3"
    },
    "1600": {
      "available": true,
      "candidate_digest": "97fe802c48371ebadc81e2722a9d9a5392b8c075dd24350427d9e546957583c1",
      "l2_distance": 1299.8337506190485,
      "reference_digest": "62db1797fa6f37afa09d842e8cf101ddc272cfcdfc526a28b44be66afb0f5d78"
    },
    "200": {
      "available": true,
      "candidate_digest": "ef3a6a70daece9de6fdc45c5dc11f8a2741d46946d2232ce60dc808567c00407",
      "l2_distance": 0.0,
      "reference_digest": "ef3a6a70daece9de6fdc45c5dc11f8a2741d46946d2232ce60dc808567c00407"
    },
    "400": {
      "available": true,
      "candidate_digest": "de460a0aca8f750f22a6071f0d1b2d029cd99b8aa371282ffd93b59958c5e380",
      "l2_distance": 0.0,
      "reference_digest": "de460a0aca8f750f22a6071f0d1b2d029cd99b8aa371282ffd93b59958c5e380"
    },
    "800": {
      "available": true,
      "candidate_digest": "1ef5fb8fdbf096d27a6c0d1b1b91c20455f1c8e68b8f95776eb09d728a5bf477",
      "l2_distance": 0.0,
      "reference_digest": "1ef5fb8fdbf096d27a6c0d1b1b91c20455f1c8e68b8f95776eb09d728a5bf477"
    }
  }
}
{
  "candidate_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped",
  "loss_divergence": {
    "auc_abs_diff": 56.01361083984375,
    "max_abs_diff": 1.4541015625,
    "mean_abs_diff": 0.035013675689697266,
    "num_common_steps": 1600
  },
  "reference_run": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_reference",
  "steps": {
    "1200": {
      "available": true,
      "candidate_digest": "06f299a92572fdd652abc83b94cfeb1dce5c37292ca4065608b808d999999ed1",
      "l2_distance": 824.8284061980333,
      "reference_digest": "a9d56782e1462c71a91decf2aa4b522e20c7ce2137fb68d9d706390ae134d1d3"
    },
    "1600": {
      "available": true,
      "candidate_digest": "97fe802c48371ebadc81e2722a9d9a5392b8c075dd24350427d9e546957583c1",
      "l2_distance": 1299.8337506190485,
      "reference_digest": "62db1797fa6f37afa09d842e8cf101ddc272cfcdfc526a28b44be66afb0f5d78"
    },
    "200": {
      "available": true,
      "candidate_digest": "ef3a6a70daece9de6fdc45c5dc11f8a2741d46946d2232ce60dc808567c00407",
      "l2_distance": 0.0,
      "reference_digest": "ef3a6a70daece9de6fdc45c5dc11f8a2741d46946d2232ce60dc808567c00407"
    },
    "400": {
      "available": true,
      "candidate_digest": "de460a0aca8f750f22a6071f0d1b2d029cd99b8aa371282ffd93b59958c5e380",
      "l2_distance": 0.0,
      "reference_digest": "de460a0aca8f750f22a6071f0d1b2d029cd99b8aa371282ffd93b59958c5e380"
    },
    "800": {
      "available": true,
      "candidate_digest": "1ef5fb8fdbf096d27a6c0d1b1b91c20455f1c8e68b8f95776eb09d728a5bf477",
      "l2_distance": 0.0,
      "reference_digest": "1ef5fb8fdbf096d27a6c0d1b1b91c20455f1c8e68b8f95776eb09d728a5bf477"
    }
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.09707781502525775,
    "mean": 9.438827926922881,
    "n": 3,
    "std": 0.08578760607730601
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_reference",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_reference",
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_reference",
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_reference"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 9.362424152251101,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_reference",
      "snapshot_time_sec_total": 0.03604869812261313,
      "stall_time_sec_total": 22.273760708398186,
      "wall_clock_time_sec": 170.8959105014801,
      "write_time_sec_total": 22.20107523421757
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 9.531631652766306,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_reference",
      "snapshot_time_sec_total": 0.039638837333768606,
      "stall_time_sec_total": 23.257988682831638,
      "wall_clock_time_sec": 167.86213088035583,
      "write_time_sec_total": 23.182387247565202
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 9.422427975751233,
      "replayed_steps": 0,
      "restarts": 0,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_reference",
      "snapshot_time_sec_total": 0.03399125533178449,
      "stall_time_sec_total": 24.56147606857121,
      "wall_clock_time_sec": 169.807612657547,
      "write_time_sec_total": 24.489430124871433
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0032344075771753825,
    "mean": 0.03655959692938874,
    "n": 3,
    "std": 0.00285824400819057
  },
  "stall_time_sec_total": {
    "ci95": 1.2985914749179035,
    "mean": 23.364408486600343,
    "n": 3,
    "std": 1.1475644963436806
  },
  "wall_clock_time_sec": {
    "ci95": 1.73921151757484,
    "mean": 169.5218846797943,
    "n": 3,
    "std": 1.5369401599737724
  },
  "write_time_sec_total": {
    "ci95": 1.2991235950927167,
    "mean": 23.290964202218067,
    "n": 3,
    "std": 1.1480347306184302
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.061534485695637006,
    "mean": 8.427762539144661,
    "n": 3,
    "std": 0.054377987572685506
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_failure_blocking",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking",
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking",
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.377341386870535,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking",
      "snapshot_time_sec_total": 0.03950369043741375,
      "stall_time_sec_total": 25.712434791144915,
      "wall_clock_time_sec": 190.9913809299469,
      "write_time_sec_total": 25.632763053523377
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.485380615724788,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking",
      "snapshot_time_sec_total": 0.038674052339047194,
      "stall_time_sec_total": 23.72320666303858,
      "wall_clock_time_sec": 188.55960297584534,
      "write_time_sec_total": 23.645930183120072
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.420565614838658,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking",
      "snapshot_time_sec_total": 0.03865784080699086,
      "stall_time_sec_total": 23.771406751824543,
      "wall_clock_time_sec": 190.01098895072937,
      "write_time_sec_total": 23.695296354824677
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.0005474028464629405,
    "mean": 0.03894519452781727,
    "n": 3,
    "std": 0.00048373956238859095
  },
  "stall_time_sec_total": {
    "ci95": 1.2841732969370947,
    "mean": 24.40234940200268,
    "n": 3,
    "std": 1.1348231612338175
  },
  "wall_clock_time_sec": {
    "ci95": 1.384483605663201,
    "mean": 189.85399095217386,
    "n": 3,
    "std": 1.2234673200279687
  },
  "write_time_sec_total": {
    "ci95": 1.2822421167390594,
    "mean": 24.324663197156042,
    "n": 3,
    "std": 1.1331165784677115
  }
}
{
  "correctness": {
    "all_passed": true,
    "pass_rate": 1.0
  },
  "goodput_steps_per_sec": {
    "ci95": 0.05339359972505502,
    "mean": 8.76254307323732,
    "n": 3,
    "std": 0.04718389159326068
  },
  "label": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_failure_overlapped",
  "num_runs": 3,
  "replayed_steps": {
    "ci95": 0.0,
    "mean": 0.0,
    "n": 3,
    "std": 0.0
  },
  "restarts": {
    "ci95": 0.0,
    "mean": 2.0,
    "n": 3,
    "std": 0.0
  },
  "run_ids": [
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped",
    "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped"
  ],
  "runs": [
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.739583353112005,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped",
      "snapshot_time_sec_total": 0.039920840063132346,
      "stall_time_sec_total": 9.67277186177671,
      "wall_clock_time_sec": 183.07508897781372,
      "write_time_sec_total": 1.9190560970455408
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.731233237522723,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped",
      "snapshot_time_sec_total": 0.04814912716392428,
      "stall_time_sec_total": 9.943844342138618,
      "wall_clock_time_sec": 183.25017285346985,
      "write_time_sec_total": 1.96620356105268
    },
    {
      "correctness_passed": true,
      "goodput_steps_per_sec": 8.816812629077232,
      "replayed_steps": 0,
      "restarts": 2,
      "run_id": "exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped",
      "snapshot_time_sec_total": 0.037130586337298155,
      "stall_time_sec_total": 9.666528208763339,
      "wall_clock_time_sec": 181.47147583961487,
      "write_time_sec_total": 1.8745924440445378
    }
  ],
  "snapshot_time_sec_total": {
    "ci95": 0.006482477015352125,
    "mean": 0.04173351785478493,
    "n": 3,
    "std": 0.005728560994636395
  },
  "stall_time_sec_total": {
    "ci95": 0.17917510964371802,
    "mean": 9.761048137559555,
    "n": 3,
    "std": 0.15833693538502241
  },
  "wall_clock_time_sec": {
    "ci95": 1.1093200343275151,
    "mean": 182.59891255696616,
    "n": 3,
    "std": 0.9803054394435242
  },
  "write_time_sec_total": {
    "ci95": 0.05184128276919958,
    "mean": 1.919950700714253,
    "n": 3,
    "std": 0.04581211004377482
  }
}
{
  "markdown": "results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_publishable.md",
  "json": "results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_publishable.json"
}
[INFO] Cleaning checkpoints for completed runs...
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_reference
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_blocking
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s1337_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s2027_failure_overlapped
[CLEANUP] removed checkpoints: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/checkpoints/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_s4242_failure_overlapped
[DONE] Publishable markdown: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_publishable.md
[DONE] Publishable json: results/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4/reports/exp4_matrix_20260216_221349_cifar100_resnet50_flate_k50_m4_publishable.json
[DONE] Manifest CSV: results/exp4_matrix_20260216_221349_manifest.csv
[DONE] Manifest MD: results/exp4_matrix_20260216_221349_manifest.md
[DONE] Summary CSV: results/exp4_matrix_20260216_221349_summary.csv
[DONE] Summary MD: results/exp4_matrix_20260216_221349_summary.md
